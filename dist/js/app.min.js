function setInfoWindow(e,o,t){var a=(t.imageSrc(),'<div id="content"><div><img id="orbot" width="200" height="150" src="'+t.imageSrc()+'"></div><div class="orbot"><button class="btn-danger" onclick="getBot()">Orbot... 3 2 1</button><p id="attributeRobot"></p></div><h4 id="firstHeading" class="firstHeading">'+t.name()+'</h4><div id="bodyContent"><p><b>'+t.name()+"</b>. "+t.snippet()+'</p><p> View on <a href="'+t.fourWeb()+'" target="_blank">FourSquare</a></p></div></div>');void 0!==infowindow&&infowindow.close(),infowindow=new google.maps.InfoWindow({content:a,maxWidth:220}),infowindow.open(e,o,t)}function addBounceTimeout(e){null!==e.getAnimation()?e.setAnimation(null):(e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},2100))}function activateMarker(e,o,t){e.panTo({lat:t.location().lat,lng:t.location().lng}),addBounceTimeout(o),setInfoWindow(e,o,t)}function resetMarkers(){void 0!==infowindow&&infowindow.close()}function getBot(){var e=document.getElementById("firstHeading").textContent;$.ajax({url:"https://robohash.p.mashape.com/index.php?",type:"GET",data:"text="+e,dataType:"json",success:function(e){document.querySelector("#orbot").src=e.imageUrl,document.querySelector("#attributeRobot").innerHTML="Friendly robot by Robohash.org"},error:function(e){alert("Does not compute, no robot rampages at this time: \n"+e.statusText)},beforeSend:function(e){e.setRequestHeader("X-Mashape-Authorization","VgMGFNmpz7mshANOJu1vyojXxtPSp1EJlqhjsndy1e69V8froV")}})}function getOrig(e){console.log(e),document.querySelector("#orbot").src=e}function googleSuccess(){"undefined"!=typeof google?(initMap(),ko.applyBindings(new ViewModel)):googleLoadError()}var localOrbe=[{name:"La Tour Ronde",location:{lat:46.725228,lng:6.532651},category:"Historic Site",fourID:"5749d0d7498eeaadc53d1a94",imgSrc:"https://static.panoramio.com.storage.googleapis.com/photos/small/55668009.jpg",snippet:"The Round Tower is part of the town's ancient castle. It offers splendid 360° panoramic views over the town, the Jura mountain range, and the Alps."},{name:"Quartier des Vieux Moulins",location:{lat:46.720926,lng:6.532467},category:"Scenic Lookout",fourID:"575ee4fe498e32bffe3b201f",imgSrc:"https://static.panoramio.com.storage.googleapis.com/photos/small/74920455.jpg",snippet:"The ancient flourmills date back to 1423 and were in use until the very end of the 1990s."},{name:"Les Gorges de l'Orbe",location:{lat:46.727536,lng:6.50911},category:"Trail",fourID:"4dfdd71ec65b31579b330f40",imgSrc:"https://static.panoramio.com.storage.googleapis.com/photos/small/55667745.jpg",snippet:"A walk through the gorges of the River Orbe presents hikers with a wealth of natural resources in the foothills of the Jura Mountains, between Vallorbe and Orbe."},{name:"Mur d'escalade, Chavornay",location:{lat:46.70769,lng:6.566871},category:"Climbing Gym",fourID:"4c74596e1b30a093c380ec09",imgSrc:"https://irs0.4sqi.net/img/general/width960/315239_vFCt6_0yyQJtH2q7LqH93FKYMI8yZUfNvrpSt1jVvDY.jpg",snippet:"The climbing wall at Chavornay is divided into five separate zones, including bouldering, children's area and lead walls."},{name:"Orbe à petits pas",location:{lat:46.723168,lng:6.52957},category:"Trail",fourID:"4f786a52e4b055c7618c157e",imgSrc:"https://static.panoramio.com.storage.googleapis.com/photos/small/20468692.jpg",snippet:"Two easy walks, marked with yellow and red steps on the ground, guide you around the town, its surroundings, and the river."}],Poi=function(e){var o=this;o.name=ko.observable(e.name),o.location=ko.observable(e.location),o.category=ko.observable(e.category),o.fourID=ko.observable(e.fourID),o.imageSrc=ko.observable(e.imgSrc),o.snippet=ko.observable(e.snippet),o.fourWeb=ko.observable(e.fourWeb),o.mapMarker=new google.maps.Marker({position:{lat:o.location().lat,lng:o.location().lng},title:o.name(),animation:google.maps.Animation.DROP,map:map}),o.mapMarker.addListener("click",function(){activateMarker(map,o.mapMarker,o)})},map,initMap=function(){var e={lat:46.724258,lng:6.532064};map=new google.maps.Map(document.getElementById("map-canvas"),{center:e,zoom:13})},infowindow,ViewModel=function(){var e=this;e.locationList=ko.observableArray([]),e.searchName=ko.observable(""),localOrbe.forEach(function(o){e.locationList.push(new Poi(o))});var o={OAUTH_TOKEN:"LOJ2DURA4KDE3HIOZH1TP0NAEP1XGIFLQP0FVAE2LHYFFKLR",baseURL:"https://api.foursquare.com/v2/venues/"};e.locationList().forEach(function(e){$.ajax({url:o.baseURL+e.fourID(),dataType:"json",data:"oauth_token="+o.OAUTH_TOKEN+"&v=20160613",success:function(o){e.fourWeb(o.response.venue.shortUrl)},error:function(e){alert("Requested FourSquare data failed to load: \n"+e.statusText)}})});var t=o.baseURL+"explore?ll=46.724258,6.532064&radius=5000&limit=5&venuePhotos=1&section=coffee&mode=url&oauth_token="+o.OAUTH_TOKEN+"&v=20160615";$.getJSON(t).done(function(o){for(var t=o.response.groups[0].items,a=[],n=0;n<t.length;n++){var i={name:t[n].venue.name,location:{lat:t[n].venue.location.lat,lng:t[n].venue.location.lng},category:t[n].venue.categories[0].shortName,fourID:t[n].venue.id,fourWeb:"https://foursquare.com/v/"+t[n].venue.id};t[n].venue.hasOwnProperty("featuredPhotos")?i.imgSrc=t[n].venue.featuredPhotos.items[0].prefix+"200x150"+t[n].venue.featuredPhotos.items[0].suffix:i.imgSrc="http://placehold.it/200x150?text="+t[n].venue.categories[0].shortName,t[n].hasOwnProperty("tips")?i.snippet=t[n].tips[0].text:i.snippet="No reviews yet...",a.push(i)}a.forEach(function(o){e.locationList.push(new Poi(o))})}).fail(function(e,o,t){var a=o+", "+t;alert("Requested FourSquare data failed to load: \n"+a)}),e.currentPoi=ko.observable(this.locationList()[0].name()),console.log(e.currentPoi()),e.searchResults=ko.computed(function(){var o=[],t=e.searchName().toLowerCase();return ko.utils.arrayFilter(e.locationList(),function(e){return e.name().toLowerCase().indexOf(t)>=0?(o.push(e),resetMarkers(),e.mapMarker.setVisible(!0),o):void e.mapMarker.setVisible(!1)})}),e.setCurrentPoi=function(o){activateMarker(map,o.mapMarker,o),e.currentPoi(o.name())}},googleLoadError=function(){alert("Google maps load error")};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJzZXRJbmZvV2luZG93IiwibWFwIiwibWFya2VyIiwicG9pIiwiY29udGVudFN0cmluZyIsImltYWdlU3JjIiwibmFtZSIsInNuaXBwZXQiLCJmb3VyV2ViIiwidW5kZWZpbmVkIiwiaW5mb3dpbmRvdyIsImNsb3NlIiwiZ29vZ2xlIiwibWFwcyIsIkluZm9XaW5kb3ciLCJjb250ZW50IiwibWF4V2lkdGgiLCJvcGVuIiwiYWRkQm91bmNlVGltZW91dCIsImdldEFuaW1hdGlvbiIsInNldEFuaW1hdGlvbiIsIkFuaW1hdGlvbiIsIkJPVU5DRSIsInNldFRpbWVvdXQiLCJhY3RpdmF0ZU1hcmtlciIsInBhblRvIiwibGF0IiwibG9jYXRpb24iLCJsbmciLCJyZXNldE1hcmtlcnMiLCJnZXRCb3QiLCJ0aXRsZSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJ0ZXh0Q29udGVudCIsIiQiLCJhamF4IiwidXJsIiwidHlwZSIsImRhdGEiLCJkYXRhVHlwZSIsInN1Y2Nlc3MiLCJxdWVyeVNlbGVjdG9yIiwic3JjIiwiaW1hZ2VVcmwiLCJpbm5lckhUTUwiLCJlcnJvciIsImVyciIsImFsZXJ0Iiwic3RhdHVzVGV4dCIsImJlZm9yZVNlbmQiLCJ4aHIiLCJzZXRSZXF1ZXN0SGVhZGVyIiwiZ2V0T3JpZyIsImNvbnNvbGUiLCJsb2ciLCJnb29nbGVTdWNjZXNzIiwiaW5pdE1hcCIsImtvIiwiYXBwbHlCaW5kaW5ncyIsIlZpZXdNb2RlbCIsImdvb2dsZUxvYWRFcnJvciIsImxvY2FsT3JiZSIsImNhdGVnb3J5IiwiZm91cklEIiwiaW1nU3JjIiwiUG9pIiwianNvbiIsInNlbGYiLCJ0aGlzIiwib2JzZXJ2YWJsZSIsIm1hcE1hcmtlciIsIk1hcmtlciIsInBvc2l0aW9uIiwiYW5pbWF0aW9uIiwiRFJPUCIsImFkZExpc3RlbmVyIiwiT1JCRSIsIk1hcCIsImNlbnRlciIsInpvb20iLCJsb2NhdGlvbkxpc3QiLCJvYnNlcnZhYmxlQXJyYXkiLCJzZWFyY2hOYW1lIiwiZm9yRWFjaCIsInB1c2giLCJmb3VySW5mbyIsIk9BVVRIX1RPS0VOIiwiYmFzZVVSTCIsInJlc3BvbnNlIiwidmVudWUiLCJzaG9ydFVybCIsImV4cGxvcmVVUkwiLCJnZXRKU09OIiwiZG9uZSIsImdvdEpTT04iLCJncm91cHMiLCJpdGVtcyIsInJlc3VsdHMiLCJpIiwibGVuZ3RoIiwiaXRlbSIsImNhdGVnb3JpZXMiLCJzaG9ydE5hbWUiLCJpZCIsImhhc093blByb3BlcnR5IiwiZmVhdHVyZWRQaG90b3MiLCJwcmVmaXgiLCJzdWZmaXgiLCJ0aXBzIiwidGV4dCIsImZhaWwiLCJqcXhociIsInRleHRTdGF0dXMiLCJjdXJyZW50UG9pIiwic2VhcmNoUmVzdWx0cyIsImNvbXB1dGVkIiwic2VhcmNoIiwidG9Mb3dlckNhc2UiLCJ1dGlscyIsImFycmF5RmlsdGVyIiwiaW5kZXhPZiIsInNldFZpc2libGUiLCJzZXRDdXJyZW50UG9pIl0sIm1hcHBpbmdzIjoiQUE0SEEsUUFBU0EsZUFBY0MsRUFBS0MsRUFBUUMsR0FDbEMsR0FDSUMsSUFET0QsRUFBSUUsV0FDSyx3RUFDc0NGLEVBQUlFLFdBQWEsK0tBS3pCRixFQUFJRyxPQUFTLG9DQUVsREgsRUFBSUcsT0FBUyxTQUFXSCxFQUFJSSxVQUFZLDRCQUN6QkosRUFBSUssVUFBWSxtREFLekJDLFVBQWZDLFlBQTBCQSxXQUFXQyxRQUN6Q0QsV0FBYSxHQUFJRSxRQUFPQyxLQUFLQyxZQUMzQkMsUUFBU1gsRUFDVFksU0FBVSxNQUVaTixXQUFXTyxLQUFLaEIsRUFBS0MsRUFBUUMsR0FHL0IsUUFBU2Usa0JBQWlCaEIsR0FDTSxPQUExQkEsRUFBT2lCLGVBQ1RqQixFQUFPa0IsYUFBYSxPQUVwQmxCLEVBQU9rQixhQUFhUixPQUFPQyxLQUFLUSxVQUFVQyxRQUMxQ0MsV0FBVyxXQUNUckIsRUFBT2tCLGFBQWEsT0FDbkIsT0FLUCxRQUFTSSxnQkFBZXZCLEVBQUtDLEVBQVFDLEdBQ25DRixFQUFJd0IsT0FD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QUFzQzhCLEVBQVFJLEdBQUdULE1BQU1ZLFdBQVcsR0FBR0MsVUFFakZSLEVBQVFJLEdBQUdNLGVBQWUsUUFDNUJKLEVBQUs5RixRQUFVd0YsRUFBUUksR0FBR1UsS0FBSyxHQUFHQyxLQUVsQ1QsRUFBSzlGLFFBQVUsb0JBRWpCMkYsRUFBUWIsS0FBS2dCLEdBR2ZILEVBQVFkLFFBQVEsU0FBU2pCLEdBQ3ZCQyxFQUFLYSxhQUFhSSxLQUFLLEdBQUluQixLQUFJQyxRQUdsQzRDLEtBQUssU0FBU0MsRUFBT0MsRUFBWW5FLEdBQ2hDLEdBQUlDLEdBQU1rRSxFQUFhLEtBQU9uRSxDQUM5QkUsT0FBTSwrQ0FBaURELEtBSTNEcUIsRUFBSzhDLFdBQWF4RCxHQUFHWSxXQUFXRCxLQUFLWSxlQUFlLEdBQUczRSxRQUN2RGdELFFBQVFDLElBQUlhLEVBQUs4QyxjQVNqQjlDLEVBQUsrQyxjQUFnQnpELEdBQUcwRCxTQUFTLFdBQy9CLEdBQUlsQixNQUVBbUIsRUFBU2pELEVBQUtlLGFBQWFtQyxhQUUvQixPQUFPNUQsSUFBRzZELE1BQU1DLFlBQVlwRCxFQUFLYSxlQUFnQixTQUFTOUUsR0FDeEQsTUFBSUEsR0FBSUcsT0FBT2dILGNBQWNHLFFBQVFKLElBQVcsR0FDOUNuQixFQUFRYixLQUFLbEYsR0FDYjBCLGVBRUExQixFQUFJb0UsVUFBVW1ELFlBQVcsR0FDbEJ4QixPQUdQL0YsR0FBSW9FLFVBQVVtRCxZQUFXLE9BTS9CdEQsRUFBS3VELGNBQWdCLFNBQVN4SCxHQUM1QnFCLGVBQWV2QixJQUFLRSxFQUFJb0UsVUFBV3BFLEdBQ25DaUUsRUFBSzhDLFdBQVcvRyxFQUFJRyxVQWVwQnVELGdCQUFrQixXQUNwQmIsTUFBTSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogPT09PT09PSBNb2RlbCA9PT09PT09ICovXG4vLyBqc29uIGRhdGEgZm9yIHBsYWNlcyBpbiBPcmJlXG4vKiA9PT09PT09ID09PT09ID09PT09PT0gKi9cblxudmFyIGxvY2FsT3JiZSA9IFt7XG4gIFwibmFtZVwiOiBcIkxhIFRvdXIgUm9uZGVcIixcbiAgXCJsb2NhdGlvblwiOiB7XG4gICAgXCJsYXRcIjogNDYuNzI1MjI4LFxuICAgIFwibG5nXCI6IDYuNTMyNjUxXG4gIH0sXG4gIFwiY2F0ZWdvcnlcIjogXCJIaXN0b3JpYyBTaXRlXCIsXG4gIFwiZm91cklEXCI6IFwiNTc0OWQwZDc0OThlZWFhZGM1M2QxYTk0XCIsXG4gIFwiaW1nU3JjXCI6IFwiaHR0cHM6Ly9zdGF0aWMucGFub3JhbWlvLmNvbS5zdG9yYWdlLmdvb2dsZWFwaXMuY29tL3Bob3Rvcy9zbWFsbC81NTY2ODAwOS5qcGdcIixcbiAgXCJzbmlwcGV0XCI6IFwiVGhlIFJvdW5kIFRvd2VyIGlzIHBhcnQgb2YgdGhlIHRvd24ncyBhbmNpZW50IGNhc3RsZS4gSXQgb2ZmZXJzIHNwbGVuZGlkIDM2MMKwIHBhbm9yYW1pYyB2aWV3cyBvdmVyIHRoZSB0b3duLCB0aGUgSnVyYSBtb3VudGFpbiByYW5nZSwgYW5kIHRoZSBBbHBzLlwiXG59LCB7XG4gIFwibmFtZVwiOiBcIlF1YXJ0aWVyIGRlcyBWaWV1eCBNb3VsaW5zXCIsXG4gIFwibG9jYXRpb25cIjoge1xuICAgIFwibGF0XCI6IDQ2LjcyMDkyNixcbiAgICBcImxuZ1wiOiA2LjUzMjQ2N1xuICB9LFxuICBcImNhdGVnb3J5XCI6IFwiU2NlbmljIExvb2tvdXRcIixcbiAgXCJmb3VySURcIjogXCI1NzVlZTRmZTQ5OGUzMmJmZmUzYjIwMWZcIixcbiAgXCJpbWdTcmNcIjogXCJodHRwczovL3N0YXRpYy5wYW5vcmFtaW8uY29tLnN0b3JhZ2UuZ29vZ2xlYXBpcy5jb20vcGhvdG9zL3NtYWxsLzc0OTIwNDU1LmpwZ1wiLFxuICBcInNuaXBwZXRcIjogXCJUaGUgYW5jaWVudCBmbG91cm1pbGxzIGRhdGUgYmFjayB0byAxNDIzIGFuZCB3ZXJlIGluIHVzZSB1bnRpbCB0aGUgdmVyeSBlbmQgb2YgdGhlIDE5OTBzLlwiXG59LCB7XG4gIFwibmFtZVwiOiBcIkxlcyBHb3JnZXMgZGUgbCdPcmJlXCIsXG4gIFwibG9jYXRpb25cIjoge1xuICAgIFwibGF0XCI6IDQ2LjcyNzUzNixcbiAgICBcImxuZ1wiOiA2LjUwOTExMFxuICB9LFxuICBcImNhdGVnb3J5XCI6IFwiVHJhaWxcIixcbiAgXCJmb3VySURcIjogXCI0ZGZkZDcxZWM2NWIzMTU3OWIzMzBmNDBcIixcbiAgXCJpbWdTcmNcIjogXCJodHRwczovL3N0YXRpYy5wYW5vcmFtaW8uY29tLnN0b3JhZ2UuZ29vZ2xlYXBpcy5jb20vcGhvdG9zL3NtYWxsLzU1NjY3NzQ1LmpwZ1wiLFxuICBcInNuaXBwZXRcIjogXCJBIHdhbGsgdGhyb3VnaCB0aGUgZ29yZ2VzIG9mIHRoZSBSaXZlciBPcmJlIHByZXNlbnRzIGhpa2VycyB3aXRoIGEgd2VhbHRoIG9mIG5hdHVyYWwgcmVzb3VyY2VzIGluIHRoZSBmb290aGlsbHMgb2YgdGhlIEp1cmEgTW91bnRhaW5zLCBiZXR3ZWVuIFZhbGxvcmJlIGFuZCBPcmJlLlwiXG59LCB7XG4gIFwibmFtZVwiOiBcIk11ciBkJ2VzY2FsYWRlLCBDaGF2b3JuYXlcIixcbiAgXCJsb2NhdGlvblwiOiB7XG4gICAgXCJsYXRcIjogNDYuNzA3NjksXG4gICAgXCJsbmdcIjogNi41NjY4NzFcbiAgfSxcbiAgXCJjYXRlZ29yeVwiOiBcIkNsaW1iaW5nIEd5bVwiLFxuICBcImZvdXJJRFwiOiBcIjRjNzQ1OTZlMWIzMGEwOTNjMzgwZWMwOVwiLFxuICBcImltZ1NyY1wiOiBcImh0dHBzOi8vaXJzMC40c3FpLm5ldC9pbWcvZ2VuZXJhbC93aWR0aDk2MC8zMTUyMzlfdkZDdDZfMHl5UUp0SDJxN0xxSDkzRktZTUk4eVpVZk52cnBTdDFqVnZEWS5qcGdcIixcbiAgXCJzbmlwcGV0XCI6IFwiVGhlIGNsaW1iaW5nIHdhbGwgYXQgQ2hhdm9ybmF5IGlzIGRpdmlkZWQgaW50byBmaXZlIHNlcGFyYXRlIHpvbmVzLCBpbmNsdWRpbmcgYm91bGRlcmluZywgY2hpbGRyZW4ncyBhcmVhIGFuZCBsZWFkIHdhbGxzLlwiXG59LCB7XG4gIFwibmFtZVwiOiBcIk9yYmUgw6AgcGV0aXRzIHBhc1wiLFxuICBcImxvY2F0aW9uXCI6IHtcbiAgICBcImxhdFwiOiA0Ni43MjMxNjgsXG4gICAgXCJsbmdcIjogNi41Mjk1NzBcbiAgfSxcbiAgXCJjYXRlZ29yeVwiOiBcIlRyYWlsXCIsXG4gIFwiZm91cklEXCI6IFwiNGY3ODZhNTJlNGIwNTVjNzYxOGMxNTdlXCIsXG4gIFwiaW1nU3JjXCI6IFwiaHR0cHM6Ly9zdGF0aWMucGFub3JhbWlvLmNvbS5zdG9yYWdlLmdvb2dsZWFwaXMuY29tL3Bob3Rvcy9zbWFsbC8yMDQ2ODY5Mi5qcGdcIixcbiAgXCJzbmlwcGV0XCI6IFwiVHdvIGVhc3kgd2Fsa3MsIG1hcmtlZCB3aXRoIHllbGxvdyBhbmQgcmVkIHN0ZXBzIG9uIHRoZSBncm91bmQsIGd1aWRlIHlvdSBhcm91bmQgdGhlIHRvd24sIGl0cyBzdXJyb3VuZGluZ3MsIGFuZCB0aGUgcml2ZXIuXCJcbn1dO1xuXG4vKiA9PT09PT09IGxpc3QgVmlldyA9PT09PT09ICovXG4vLyBQb2koKSBQb2ludCBvZiBJbnRlcmVzdFxuLy8gb2JzZXJ2YWJsZXM6XG4vLyBQb2kubmFtZVxuLy8gUG9pLmxvY2F0aW9uXG4vLyBQb2kuY2F0ZWdvcnlcbi8vIFBvaS5pbWFnZVNyY1xuLy8gUG9pLmZvdXJJRFxuLy8gUG9pLmZvdXJXZWJcbi8vIFBvaS5zbmlwcGV0XG4vKiA9PT09PT09ID09PT09PT09PSA9PT09PT09ICovXG5cbi8vIGpzb24gaXMgYW4gb2JqZWN0IGxpdGVyYWwgdGhhdCBjb250YWlucyBsb2NhdGlvbiBkYXRhIGZvciBhIHNpbmdsZSBwb2kgaW4gT3JiZVxuLy8gUG9pIGlzIGFuIG9iamVjdCBjb25zdHVjdG9yIGZvciBhIHNpbmdsZSBwbGFjZSBvZiBpbnRlcmVzdFxudmFyIFBvaSA9IGZ1bmN0aW9uKGpzb24pIHtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICBzZWxmLm5hbWUgPSBrby5vYnNlcnZhYmxlKGpzb24ubmFtZSk7XG4gIHNlbGYubG9jYXRpb24gPSBrby5vYnNlcnZhYmxlKGpzb24ubG9jYXRpb24pO1xuICBzZWxmLmNhdGVnb3J5ID0ga28ub2JzZXJ2YWJsZShqc29uLmNhdGVnb3J5KTtcbiAgc2VsZi5mb3VySUQgPSBrby5vYnNlcnZhYmxlKGpzb24uZm91cklEKTtcbiAgc2VsZi5pbWFnZVNyYyA9IGtvLm9ic2VydmFibGUoanNvbi5pbWdTcmMpO1xuICBzZWxmLnNuaXBwZXQgPSBrby5vYnNlcnZhYmxlKGpzb24uc25pcHBldCk7XG4gIHNlbGYuZm91cldlYiA9IGtvLm9ic2VydmFibGUoanNvbi5mb3VyV2ViKTtcbiAgLy8gYXR0YWNoIHRoZSBtYXAgbWFya2VyIGZvciB0aGlzIFBvaSBvYmplY3RcbiAgc2VsZi5tYXBNYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcbiAgICBwb3NpdGlvbjoge1xuICAgICAgbGF0OiBzZWxmLmxvY2F0aW9uKCkubGF0LFxuICAgICAgbG5nOiBzZWxmLmxvY2F0aW9uKCkubG5nXG4gICAgfSxcbiAgICB0aXRsZTogc2VsZi5uYW1lKCksXG4gICAgYW5pbWF0aW9uOiBnb29nbGUubWFwcy5BbmltYXRpb24uRFJPUCxcbiAgICBtYXA6IG1hcFxuICB9KTtcbiAgLy8gIGFkZCBjbGljayBoYW5kbGVyIHRvIG1hcmtlclxuICBzZWxmLm1hcE1hcmtlci5hZGRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICBhY3RpdmF0ZU1hcmtlcihtYXAsIHNlbGYubWFwTWFya2VyLCBzZWxmKTtcbiAgfSk7XG59O1xuXG5cbi8qID09PT09PT0gR29vZ2xlIE1hcHMgPT09PT09PSAqL1xuLy8gbWFwLCBpbmZvd2luZG93XG4vLyBpbml0TWFwKClcbi8vIHNldEluZm9XaW5kb3cobWFwLCBtYXJrZXIsIHBvaSlcbi8vIGFkZEJvdW5jZVRpbWVvdXQobWFya2VyKVxuLy8gYWN0aXZhdGVNYXJrZXIobWFwLCBtYXJrZXIsIHBvaSlcbi8vIHJlc2V0TWFya2VycygpXG4vLyBnZXRCb3QoKVxuLy8gZ2V0T3JpZyhpbWFnZVNyYylcbi8qID09PT09PT0gPT09PT09PT09PT0gPT09PT09PSAqL1xuXG4vLyBzaW1wbGUgbWFwIGV4YW1wbGUgZnJvbSBnb29nbGUgYXBpXG52YXIgbWFwO1xudmFyIGluaXRNYXAgPSBmdW5jdGlvbigpIHtcbiAgdmFyIE9SQkUgPSB7XG4gICAgbGF0OiA0Ni43MjQyNTgsXG4gICAgbG5nOiA2LjUzMjA2NFxuICB9O1xuICBtYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAtY2FudmFzJyksIHtcbiAgICBjZW50ZXI6IE9SQkUsXG4gICAgem9vbTogMTNcbiAgfSk7XG59O1xuXG4vLyBhZGQgc2ltcGxlIGluZm8gd2luZG93IHRvIHBvaSBtYXJrZXJcbi8vIG9ubHkgd2FudCBvbmUgaW5mbyB3aW5kb3cgb3BlbiBhdCBhIHRpbWUuIHVzZSBnbG9iYWwgdG8ga2VlcCB0cmFjayBvZiBleGlzdGluZyB3aW5kb3dcbnZhciBpbmZvd2luZG93O1xuXG5mdW5jdGlvbiBzZXRJbmZvV2luZG93KG1hcCwgbWFya2VyLCBwb2kpIHtcbiAgdmFyIG9yaWcgPSBwb2kuaW1hZ2VTcmMoKTtcbiAgdmFyIGNvbnRlbnRTdHJpbmcgPSAnPGRpdiBpZD1cImNvbnRlbnRcIj4nICtcbiAgICAnPGRpdj48aW1nIGlkPVwib3Jib3RcIiB3aWR0aD1cIjIwMFwiIGhlaWdodD1cIjE1MFwiIHNyYz1cIicgKyBwb2kuaW1hZ2VTcmMoKSArICdcIj48L2Rpdj4nICtcbiAgICAnPGRpdiBjbGFzcz1cIm9yYm90XCI+PGJ1dHRvbiBjbGFzcz1cImJ0bi1kYW5nZXJcIiBvbmNsaWNrPVwiZ2V0Qm90KClcIj5PcmJvdC4uLiAzIDIgMTwvYnV0dG9uPicgK1xuICAgICc8cCBpZD1cImF0dHJpYnV0ZVJvYm90XCI+PC9wPicgK1xuICAgIC8vJzxidXR0b24gY2xhc3M9XCJidG4tc3VjY2Vzc1wiIG9uY2xpY2s9XCJnZXRPcmlnKCcrIG9yaWcgKycpXCI+V2hvYS4uLiBVbmRvISE8L2J1dHRvbj4nICtcbiAgICAnPC9kaXY+JyArXG4gICAgJzxoNCBpZD1cImZpcnN0SGVhZGluZ1wiIGNsYXNzPVwiZmlyc3RIZWFkaW5nXCI+JyArIHBvaS5uYW1lKCkgKyAnPC9oND4nICtcbiAgICAnPGRpdiBpZD1cImJvZHlDb250ZW50XCI+JyArXG4gICAgJzxwPjxiPicgKyBwb2kubmFtZSgpICsgJzwvYj4uICcgKyBwb2kuc25pcHBldCgpICsgJzwvcD4nICtcbiAgICAnPHA+IFZpZXcgb24gPGEgaHJlZj1cIicgKyBwb2kuZm91cldlYigpICsgJ1wiIHRhcmdldD1cIl9ibGFua1wiPkZvdXJTcXVhcmU8L2E+PC9wPicgK1xuICAgICc8L2Rpdj4nICtcbiAgICAnPC9kaXY+JztcblxuICAvLyBpZiBhbiBvcGVuIHdpbmRvdyBleGlzdHMsIGNsb3NlIGl0IGJlZm9yZSBtYWtpbmcgbmV3IG9uZVxuICBpZiAoaW5mb3dpbmRvdyAhPT0gdW5kZWZpbmVkKSBpbmZvd2luZG93LmNsb3NlKCk7XG4gIGluZm93aW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdyh7XG4gICAgY29udGVudDogY29udGVudFN0cmluZyxcbiAgICBtYXhXaWR0aDogMjIwXG4gIH0pO1xuICBpbmZvd2luZG93Lm9wZW4obWFwLCBtYXJrZXIsIHBvaSk7XG59XG5cbmZ1bmN0aW9uIGFkZEJvdW5jZVRpbWVvdXQobWFya2VyKSB7XG4gIGlmIChtYXJrZXIuZ2V0QW5pbWF0aW9uKCkgIT09IG51bGwpIHtcbiAgICBtYXJrZXIuc2V0QW5pbWF0aW9uKG51bGwpO1xuICB9IGVsc2Uge1xuICAgIG1hcmtlci5zZXRBbmltYXRpb24oZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkJPVU5DRSk7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgIG1hcmtlci5zZXRBbmltYXRpb24obnVsbCk7XG4gICAgfSwgMjEwMCk7XG4gIH1cbn1cblxuLy8gZ29vZ2xlIG1hcHMgcGFuVG8gbWV0aG9kIHVzZWQgdG8gY2hhbmdlIHRoZSBjZW50ZXIgb2YgdGhlIG1hcCB0byB0aGUgZ2l2ZW4gTGF0TG5nXG5mdW5jdGlvbiBhY3RpdmF0ZU1hcmtlcihtYXAsIG1hcmtlciwgcG9pKSB7XG4gIG1hcC5wYW5Ubyh7XG4gICAgbGF0OiBwb2kubG9jYXRpb24oKS5sYXQsXG4gICAgbG5nOiBwb2kubG9jYXRpb24oKS5sbmdcbiAgfSk7XG4gIGFkZEJvdW5jZVRpbWVvdXQobWFya2VyKTtcbiAgc2V0SW5mb1dpbmRvdyhtYXAsIG1hcmtlciwgcG9pKTtcbn1cblxuZnVuY3Rpb24gcmVzZXRNYXJrZXJzKCkge1xuICAvLyBpZiBhbiBvcGVuIHdpbmRvdyBleGlzdHMsIGNsb3NlIGl0XG4gIGlmIChpbmZvd2luZG93ICE9PSB1bmRlZmluZWQpIGluZm93aW5kb3cuY2xvc2UoKTtcbn1cblxuZnVuY3Rpb24gZ2V0Qm90KCkge1xuICB2YXIgdGl0bGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZpcnN0SGVhZGluZ1wiKS50ZXh0Q29udGVudDtcbiAgdmFyIG91dHB1dCA9ICQuYWpheCh7XG4gICAgdXJsOiAnaHR0cHM6Ly9yb2JvaGFzaC5wLm1hc2hhcGUuY29tL2luZGV4LnBocD8nLCAvLyBUaGUgVVJMIHRvIHRoZSBBUEkuIFlvdSBjYW4gZ2V0IHRoaXMgYnkgY2xpY2tpbmcgb24gXCJTaG93IENVUkwgZXhhbXBsZVwiIGZyb20gYW4gQVBJIHByb2ZpbGVcbiAgICB0eXBlOiAnR0VUJywgLy8gVGhlIEhUVFAgTWV0aG9kLCBjYW4gYmUgR0VUIFBPU1QgUFVUIERFTEVURSBldGNcbiAgICBkYXRhOiAndGV4dD0nICsgdGl0bGUsIC8vIEFkZGl0aW9uYWwgcGFyYW1ldGVycyBoZXJlXG4gICAgZGF0YVR5cGU6ICdqc29uJyxcbiAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI29yYm90XCIpLnNyYyA9IGRhdGEuaW1hZ2VVcmw7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F0dHJpYnV0ZVJvYm90XCIpLmlubmVySFRNTCA9IFwiRnJpZW5kbHkgcm9ib3QgYnkgUm9ib2hhc2gub3JnXCI7XG4gICAgfSxcbiAgICBlcnJvcjogZnVuY3Rpb24oZXJyKSB7XG4gICAgICBhbGVydChcIkRvZXMgbm90IGNvbXB1dGUsIG5vIHJvYm90IHJhbXBhZ2VzIGF0IHRoaXMgdGltZTogXFxuXCIgKyBlcnIuc3RhdHVzVGV4dCk7XG4gICAgfSxcbiAgICBiZWZvcmVTZW5kOiBmdW5jdGlvbih4aHIpIHtcbiAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKFwiWC1NYXNoYXBlLUF1dGhvcml6YXRpb25cIiwgXCJWZ01HRk5tcHo3bXNoQU5PSnUxdnlvalh4dFBTcDFFSmxxaGpzbmR5MWU2OVY4ZnJvVlwiKTsgLy8gRW50ZXIgaGVyZSB5b3VyIE1hc2hhcGUga2V5XG4gICAgfVxuICB9KTtcbn1cblxuLy8gSSBjYW5ub3QgZ2V0IGEgcmVzZXQgYnV0dG9uIHRvIHdvcmshXG4vLyB1bmNvbW1lbnQgbGluZSBiZWcgPGJ1dHRvbiBjbGFzcz1cImJ0bi1zdWNjZXNzXCIgaW4gc2V0SW5mb1dpbmRvd1xuLy8gZ2V0IHRoaXMgZXJyb3IgbWVzc2FnZTpcbi8vIFVuY2F1Z2h0IFN5bnRheEVycm9yOiBtaXNzaW5nICkgYWZ0ZXIgYXJndW1lbnQgbGlzdFxuLy8gPz8/IHNlZW1zIHRvIHJlZmVyIHRvIGluZGV4Lmh0bWwgPCFET0NUWVBFIGh0bWw+XG5mdW5jdGlvbiBnZXRPcmlnKGltYWdlU3JjKSB7XG4gIGNvbnNvbGUubG9nKGltYWdlU3JjKTtcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNvcmJvdFwiKS5zcmMgPSBpbWFnZVNyYztcbn1cblxuLyogPT09PT09PSBWaWV3TW9kZWwgPT09PT09PSAqL1xuLy8gVmlld01vZGVsKClcbi8qID09PT09PT0gPT09PT09PT09PT0gPT09PT09PSAqL1xuXG52YXIgVmlld01vZGVsID0gZnVuY3Rpb24oKSB7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgLy8gY3JlYXRlIGFycmF5IG9mIHBsYWNlc1xuICBzZWxmLmxvY2F0aW9uTGlzdCA9IGtvLm9ic2VydmFibGVBcnJheShbXSk7XG4gIHNlbGYuc2VhcmNoTmFtZSA9IGtvLm9ic2VydmFibGUoJycpO1xuXG4gIC8vIHBhc3MgbG9jYWxPcmJlIG9iamVjdCBsaXRlcmFsIGpzb24gZGF0YSB0byBuZXcgUG9pXG4gIC8vIGxvb3Agb3ZlciB0aGUganNvbiBhcnJheSBhbmQgcHVzaCBlYWNoIG5ldyBwb2kgaW50byBsb2NhdGlvbkxpc3RcbiAgLy8gdXNlICdzZWxmJyB0byBhdm9pZCAndGhpcycga2V5d29yZCBzY29wZSBjb25mdXNpb25cbiAgbG9jYWxPcmJlLmZvckVhY2goZnVuY3Rpb24oanNvbikge1xuICAgIHNlbGYubG9jYXRpb25MaXN0LnB1c2gobmV3IFBvaShqc29uKSk7XG4gIH0pO1xuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvLyBGb3VyU3F1YXJlIEFQSVxuICAvLyBodHRwczovL2FwaS5mb3Vyc3F1YXJlLmNvbS92Mi92ZW51ZXMvZXhwbG9yZVxuICAvLyBodHRwczovL2FwaS5mb3Vyc3F1YXJlLmNvbS92Mi92ZW51ZXMvVkVOVUVfSURcbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gYWRkIGRldGFpbCB0byBoYXJkY29kZWRcbiAgLy8gRm9yIGVhY2ggcG9pIGluIGxvY2F0aW9uTGlzdCwgcmVxdWVzdCBGb3Vyc3F1YXJlIGRhdGEgZm9yIHRoZSBpbmZvd2luZG93XG4gIHZhciBmb3VySW5mbyA9IHtcbiAgICBPQVVUSF9UT0tFTjogJ0xPSjJEVVJBNEtERTNISU9aSDFUUDBOQUVQMVhHSUZMUVAwRlZBRTJMSFlGRktMUicsXG4gICAgYmFzZVVSTDogJ2h0dHBzOi8vYXBpLmZvdXJzcXVhcmUuY29tL3YyL3ZlbnVlcy8nXG4gIH07XG5cbiAgLy8gbWFrZSBBamF4IHJlcXVlc3Qgb24gVkVOVUVfSUQgdG8gYWRkIGxpbmsgc3VwcGxpZWQgYnkgZm91cnNxdWFyZSB0byBlYWNoIGV4aXN0aW5nIHBvaVxuICBzZWxmLmxvY2F0aW9uTGlzdCgpLmZvckVhY2goZnVuY3Rpb24ocG9pKSB7XG4gICAgJC5hamF4KHtcbiAgICAgIHVybDogZm91ckluZm8uYmFzZVVSTCArIHBvaS5mb3VySUQoKSxcbiAgICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgICBkYXRhOiAnb2F1dGhfdG9rZW49JyArIGZvdXJJbmZvLk9BVVRIX1RPS0VOICtcbiAgICAgICAgJyZ2PTIwMTYwNjEzJyxcbiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgcG9pLmZvdXJXZWIoZGF0YS5yZXNwb25zZS52ZW51ZS5zaG9ydFVybCk7XG4gICAgICB9LFxuICAgICAgZXJyb3I6IGZ1bmN0aW9uKGVycikge1xuICAgICAgICBhbGVydChcIlJlcXVlc3RlZCBGb3VyU3F1YXJlIGRhdGEgZmFpbGVkIHRvIGxvYWQ6IFxcblwiICsgZXJyLnN0YXR1c1RleHQpO1xuICAgICAgfSxcbiAgICB9KTtcbiAgfSk7XG5cbiAgLy8gZXhhbXBsZSBvZiBjYWxsIHRvIGV4cGxvcmVcbiAgLy8gaHR0cHM6Ly9hcGkuZm91cnNxdWFyZS5jb20vdjIvdmVudWVzL2V4cGxvcmU/bGw9NDAuNywtNzQmb2F1dGhfdG9rZW49TE9KMkRVUkE0S0RFM0hJT1pIMVRQME5BRVAxWEdJRkxRUDBGVkFFMkxIWUZGS0xSJnY9MjAxNjA2MTVcbiAgLy8gYmFzZWQgb24ganNvbiBvdXRwdXQgd2FudCB0byBuYXJyb3cgaW4gb246IGRhdGEucmVzcG9uc2UuZ3JvdXBzWzBdLml0ZW1zXG4gIC8vIHRoZW4gZHJpbGwgZG93biB0bzpcbiAgLy8gdmVudWUuaWQgdmVudWUubmFtZVxuICAvLyB2ZW51ZS5sb2NhdGlvbi5sYXQgdmVudWUubG9jYXRpb24ubG5nXG4gIC8vIHZlbnVlLmZlYXR1cmVkUGhvdG9zLml0ZW1zWzBdLnByZWZpeCAuc3VmZml4ICAuaWQgLy8gY2FuIG5vdCBiZSByZWxpZWQgdXBvbiBhcyBmZWF0dXJlZFBob3RvcyBteSBub3QgZXhpc3RcbiAgLy8gdGlwc1swXS5jYW5vbmljYWxVcmwgdGlwc1swXS50ZXh0IC8vIGNhbiBub3QgYmUgcmVsaWVkIHVwb24gYXMgdGlwcyBteSBub3QgZXhpc3RcblxuICAvLyBTdGVwIDE6IEdldCB0aGUgcmVzdWx0c1xuICB2YXIgZXhwbG9yZVVSTCA9IGZvdXJJbmZvLmJhc2VVUkwgK1xuICAgICdleHBsb3JlP2xsPTQ2LjcyNDI1OCw2LjUzMjA2NCZyYWRpdXM9NTAwMCZsaW1pdD01JnZlbnVlUGhvdG9zPTEnICtcbiAgICAnJnNlY3Rpb249Y29mZmVlJyArXG4gICAgJyZtb2RlPXVybCcgK1xuICAgICcmb2F1dGhfdG9rZW49JyArIGZvdXJJbmZvLk9BVVRIX1RPS0VOICtcbiAgICAnJnY9MjAxNjA2MTUnO1xuXG4gICQuZ2V0SlNPTihleHBsb3JlVVJMKVxuICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgIHZhciBnb3RKU09OID0gZGF0YS5yZXNwb25zZS5ncm91cHNbMF0uaXRlbXM7XG4gICAgICAvLyBTdGVwIDI6IFByb2Nlc3MgdGhlIHJlc3VsdHMgaW50byB0aGUgZm9ybSB5b3Ugd2FudFxuICAgICAgdmFyIHJlc3VsdHMgPSBbXTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZ290SlNPTi5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgaXRlbSA9IHtcbiAgICAgICAgICBcIm5hbWVcIjogZ290SlNPTltpXS52ZW51ZS5uYW1lLFxuICAgICAgICAgIFwibG9jYXRpb25cIjoge1xuICAgICAgICAgICAgXCJsYXRcIjogZ290SlNPTltpXS52ZW51ZS5sb2NhdGlvbi5sYXQsXG4gICAgICAgICAgICBcImxuZ1wiOiBnb3RKU09OW2ldLnZlbnVlLmxvY2F0aW9uLmxuZ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJjYXRlZ29yeVwiOiBnb3RKU09OW2ldLnZlbnVlLmNhdGVnb3JpZXNbMF0uc2hvcnROYW1lLFxuICAgICAgICAgIFwiZm91cklEXCI6IGdvdEpTT05baV0udmVudWUuaWQsXG4gICAgICAgICAgXCJmb3VyV2ViXCI6IFwiaHR0cHM6Ly9mb3Vyc3F1YXJlLmNvbS92L1wiICsgZ290SlNPTltpXS52ZW51ZS5pZFxuICAgICAgICB9O1xuICAgICAgICBpZiAoZ290SlNPTltpXS52ZW51ZS5oYXNPd25Qcm9wZXJ0eSgnZmVhdHVyZWRQaG90b3MnKSkge1xuICAgICAgICAgIGl0ZW0uaW1nU3JjID0gZ290SlNPTltpXS52ZW51ZS5mZWF0dXJlZFBob3Rvcy5pdGVtc1swXS5wcmVmaXggKyAnMjAweDE1MCcgKyBnb3RKU09OW2ldLnZlbnVlLmZlYXR1cmVkUGhvdG9zLml0ZW1zWzBdLnN1ZmZpeDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpdGVtLmltZ1NyYyA9IFwiaHR0cDovL3BsYWNlaG9sZC5pdC8yMDB4MTUwP3RleHQ9XCIgKyBnb3RKU09OW2ldLnZlbnVlLmNhdGVnb3JpZXNbMF0uc2hvcnROYW1lO1xuICAgICAgICB9XG4gICAgICAgIGlmIChnb3RKU09OW2ldLmhhc093blByb3BlcnR5KCd0aXBzJykpIHtcbiAgICAgICAgICBpdGVtLnNuaXBwZXQgPSBnb3RKU09OW2ldLnRpcHNbMF0udGV4dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpdGVtLnNuaXBwZXQgPSBcIk5vIHJldmlld3MgeWV0Li4uXCI7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0cy5wdXNoKGl0ZW0pO1xuICAgICAgfVxuICAgICAgLy8gZG8gb3RoZXIgd29yayB3aXRoIHlvdXIgcmVzdWx0cyBiZWxvdyBoZXJlXG4gICAgICByZXN1bHRzLmZvckVhY2goZnVuY3Rpb24oanNvbikge1xuICAgICAgICBzZWxmLmxvY2F0aW9uTGlzdC5wdXNoKG5ldyBQb2koanNvbikpO1xuICAgICAgfSk7XG4gICAgfSlcbiAgICAuZmFpbChmdW5jdGlvbihqcXhociwgdGV4dFN0YXR1cywgZXJyb3IpIHtcbiAgICAgIHZhciBlcnIgPSB0ZXh0U3RhdHVzICsgXCIsIFwiICsgZXJyb3I7XG4gICAgICBhbGVydChcIlJlcXVlc3RlZCBGb3VyU3F1YXJlIGRhdGEgZmFpbGVkIHRvIGxvYWQ6IFxcblwiICsgZXJyKTtcbiAgICB9KTtcblxuICAvLyB1c2UgZmlyc3QgcG9pIGluIE9yYmUgdG8gdGVzdCBzZWxlY3RlZCBwbGFjZVxuICBzZWxmLmN1cnJlbnRQb2kgPSBrby5vYnNlcnZhYmxlKHRoaXMubG9jYXRpb25MaXN0KClbMF0ubmFtZSgpKTtcbiAgY29uc29sZS5sb2coc2VsZi5jdXJyZW50UG9pKCkpO1xuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvLyBzZWFyY2ggc2VjdGlvblxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAvLyBkYXRhLWJpbmQgc2VhcmNoTmFtZSB0byB0aGUgZm9ybSBpbnB1dCBpbiBsZWZ0IG5hdiAtIHZhbHVlOiBzZWFyY2hOYW1lXG4gIC8vIGRhdGEtYmluZCB0byB1cGRhdGUgb24gbmV3IGxldHRlciAtIHZhbHVlVXBkYXRlOiAnYWZ0ZXJrZXlkb3duJ1xuICAvLyBzZXRWaXNpYmxlIGlzIGEgbWV0aG9kIG9uIGdvb2dsZSBtYXJrZXJcbiAgc2VsZi5zZWFyY2hSZXN1bHRzID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgdmFyIHJlc3VsdHMgPSBbXTtcbiAgICAvLyB1c2UgdmFsdWUgaW4gc2VhcmNoIGJveFxuICAgIHZhciBzZWFyY2ggPSBzZWxmLnNlYXJjaE5hbWUoKS50b0xvd2VyQ2FzZSgpO1xuICAgIC8vIHN0cmluZyBtYXRjaCBmb3IgZWFjaCBwb2kubmFtZSBpbiB0aGUgbG9jYXRpb24gbGlzdFxuICAgIHJldHVybiBrby51dGlscy5hcnJheUZpbHRlcihzZWxmLmxvY2F0aW9uTGlzdCgpLCBmdW5jdGlvbihwb2kpIHtcbiAgICAgIGlmIChwb2kubmFtZSgpLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihzZWFyY2gpID49IDApIHtcbiAgICAgICAgcmVzdWx0cy5wdXNoKHBvaSk7XG4gICAgICAgIHJlc2V0TWFya2VycygpO1xuICAgICAgICAvLyBzaG93IG1hcmtlclxuICAgICAgICBwb2kubWFwTWFya2VyLnNldFZpc2libGUodHJ1ZSk7XG4gICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gaGlkZSBtYXJrZXJcbiAgICAgICAgcG9pLm1hcE1hcmtlci5zZXRWaXNpYmxlKGZhbHNlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG5cbiAgLy8gY2xpY2sgb24gbGlzdCBpdGVtXG4gIHNlbGYuc2V0Q3VycmVudFBvaSA9IGZ1bmN0aW9uKHBvaSkge1xuICAgIGFjdGl2YXRlTWFya2VyKG1hcCwgcG9pLm1hcE1hcmtlciwgcG9pKTtcbiAgICBzZWxmLmN1cnJlbnRQb2kocG9pLm5hbWUoKSk7XG4gIH07XG59O1xuXG4vLyBJZiBjYWxsIHRvIGdvb2dsZSBtYXBzIGFwaSBzdWNjZXNzZnVsIGNyZWF0ZSB2aWV3bW9kZWwgYW5kIGFwcGx5IGJpbmRpbmdzXG5mdW5jdGlvbiBnb29nbGVTdWNjZXNzKCkge1xuICBpZiAodHlwZW9mIGdvb2dsZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBpbml0TWFwKCk7XG4gICAga28uYXBwbHlCaW5kaW5ncyhuZXcgVmlld01vZGVsKCkpO1xuICB9IGVsc2Uge1xuICAgIGdvb2dsZUxvYWRFcnJvcigpO1xuICB9XG59XG5cbi8vIEVycm9yIGhhbmRsaW5nIGZvciB0aGUgR29vZ2xlIE1hcHNcbnZhciBnb29nbGVMb2FkRXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgYWxlcnQoJ0dvb2dsZSBtYXBzIGxvYWQgZXJyb3InKTtcbn07XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
