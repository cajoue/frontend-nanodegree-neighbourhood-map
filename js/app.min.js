function setInfoWindow(e,o,t){var a=(t.imageSrc(),'<div id="content"><div><img id="orbot" width="200" height="150" src="'+t.imageSrc()+'"></div><div class="orbot"><button class="btn-danger" onclick="getBot()">Orbot... 3 2 1</button><p id="attributeRobot"></p></div><h4 id="firstHeading" class="firstHeading">'+t.name()+'</h4><div id="bodyContent"><p><b>'+t.name()+"</b>. "+t.snippet()+'</p><p> View on <a href="'+t.fourWeb()+'" target="_blank">FourSquare</a></p></div></div>');void 0!==infowindow&&infowindow.close(),infowindow=new google.maps.InfoWindow({content:a,maxWidth:220}),infowindow.open(e,o,t)}function addBounceTimeout(e){null!==e.getAnimation()?e.setAnimation(null):(e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},2100))}function activateMarker(e,o,t){e.panTo({lat:t.location().lat,lng:t.location().lng}),addBounceTimeout(o),setInfoWindow(e,o,t)}function resetMarkers(){void 0!==infowindow&&infowindow.close()}function getBot(){var e=document.getElementById("firstHeading").textContent;$.ajax({url:"https://robohash.p.mashape.com/index.php?",type:"GET",data:"text="+e,dataType:"json",success:function(e){document.getElementById("orbot").src=e.imageUrl,document.getElementById("attributeRobot").innerHTML="Friendly robot by Robohash.org"},error:function(e){alert("Does not compute, no robot rampages at this time: \n"+e.statusText)},beforeSend:function(e){e.setRequestHeader("X-Mashape-Authorization","VgMGFNmpz7mshANOJu1vyojXxtPSp1EJlqhjsndy1e69V8froV")}})}function getOrig(e){console.log(e),document.querySelector("#orbot").src=e}function googleSuccess(){"undefined"!=typeof google?(initMap(),ko.applyBindings(new ViewModel)):googleLoadError()}var localOrbe=[{name:"La Tour Ronde",location:{lat:46.725228,lng:6.532651},category:"Historic Site",fourID:"5749d0d7498eeaadc53d1a94",imgSrc:"https://static.panoramio.com.storage.googleapis.com/photos/small/55668009.jpg",snippet:"The Round Tower is part of the town's ancient castle. It offers splendid 360° panoramic views over the town, the Jura mountain range, and the Alps."},{name:"Quartier des Vieux Moulins",location:{lat:46.720926,lng:6.532467},category:"Scenic Lookout",fourID:"575ee4fe498e32bffe3b201f",imgSrc:"https://static.panoramio.com.storage.googleapis.com/photos/small/74920455.jpg",snippet:"The ancient flourmills date back to 1423 and were in use until the very end of the 1990s."},{name:"Les Gorges de l'Orbe",location:{lat:46.727536,lng:6.50911},category:"Trail",fourID:"4dfdd71ec65b31579b330f40",imgSrc:"https://static.panoramio.com.storage.googleapis.com/photos/small/55667745.jpg",snippet:"A walk through the gorges of the River Orbe presents hikers with a wealth of natural resources in the foothills of the Jura Mountains, between Vallorbe and Orbe."},{name:"Mur d'escalade, Chavornay",location:{lat:46.70769,lng:6.566871},category:"Climbing Gym",fourID:"4c74596e1b30a093c380ec09",imgSrc:"https://irs0.4sqi.net/img/general/width960/315239_vFCt6_0yyQJtH2q7LqH93FKYMI8yZUfNvrpSt1jVvDY.jpg",snippet:"The climbing wall at Chavornay is divided into five separate zones, including bouldering, children's area and lead walls."},{name:"Orbe à petits pas",location:{lat:46.723168,lng:6.52957},category:"Trail",fourID:"4f786a52e4b055c7618c157e",imgSrc:"https://static.panoramio.com.storage.googleapis.com/photos/small/20468692.jpg",snippet:"Two easy walks, marked with yellow and red steps on the ground, guide you around the town, its surroundings, and the river."}],Poi=function(e){var o=this;o.name=ko.observable(e.name),o.location=ko.observable(e.location),o.category=ko.observable(e.category),o.fourID=ko.observable(e.fourID),o.imageSrc=ko.observable(e.imgSrc),o.snippet=ko.observable(e.snippet),o.fourWeb=ko.observable(e.fourWeb),o.mapMarker=new google.maps.Marker({position:{lat:o.location().lat,lng:o.location().lng},title:o.name(),animation:google.maps.Animation.DROP,map:map}),o.mapMarker.addListener("click",function(){activateMarker(map,o.mapMarker,o)})},map,initMap=function(){var e={lat:46.724258,lng:6.532064};map=new google.maps.Map(document.getElementById("map-canvas"),{center:e,zoom:13})},infowindow,ViewModel=function(){var e=this;e.locationList=ko.observableArray([]),e.searchName=ko.observable(""),localOrbe.forEach(function(o){e.locationList.push(new Poi(o))});var o={OAUTH_TOKEN:"LOJ2DURA4KDE3HIOZH1TP0NAEP1XGIFLQP0FVAE2LHYFFKLR",baseURL:"https://api.foursquare.com/v2/venues/"};e.locationList().forEach(function(e){$.ajax({url:o.baseURL+e.fourID(),dataType:"json",data:"oauth_token="+o.OAUTH_TOKEN+"&v=20160613",success:function(o){e.fourWeb(o.response.venue.shortUrl)},error:function(e){alert("Requested FourSquare data failed to load: \n"+e.statusText)}})});var t=o.baseURL+"explore?ll=46.724258,6.532064&radius=5000&limit=5&venuePhotos=1&section=coffee&mode=url&oauth_token="+o.OAUTH_TOKEN+"&v=20160615";$.getJSON(t).done(function(o){for(var t=o.response.groups[0].items,a=[],n=0;n<t.length;n++){var i={name:t[n].venue.name,location:{lat:t[n].venue.location.lat,lng:t[n].venue.location.lng},category:t[n].venue.categories[0].shortName,fourID:t[n].venue.id,fourWeb:"https://foursquare.com/v/"+t[n].venue.id};t[n].venue.hasOwnProperty("featuredPhotos")?i.imgSrc=t[n].venue.featuredPhotos.items[0].prefix+"200x150"+t[n].venue.featuredPhotos.items[0].suffix:i.imgSrc="http://placehold.it/200x150?text="+t[n].venue.categories[0].shortName,t[n].hasOwnProperty("tips")?i.snippet=t[n].tips[0].text:i.snippet="No reviews yet...",a.push(i)}a.forEach(function(o){e.locationList.push(new Poi(o))})}).fail(function(e,o,t){var a=o+", "+t;alert("Requested FourSquare data failed to load: \n"+a)}),e.currentPoi=ko.observable(this.locationList()[0].name()),console.log(e.currentPoi()),e.searchResults=ko.computed(function(){var o=[],t=e.searchName().toLowerCase();return ko.utils.arrayFilter(e.locationList(),function(e){return e.name().toLowerCase().indexOf(t)>=0?(o.push(e),resetMarkers(),e.mapMarker.setVisible(!0),o):void e.mapMarker.setVisible(!1)})}),e.setCurrentPoi=function(o){activateMarker(map,o.mapMarker,o),e.currentPoi(o.name())}},googleLoadError=function(){alert("Google maps load error")};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJzZXRJbmZvV2luZG93IiwibWFwIiwibWFya2VyIiwicG9pIiwiY29udGVudFN0cmluZyIsImltYWdlU3JjIiwibmFtZSIsInNuaXBwZXQiLCJmb3VyV2ViIiwidW5kZWZpbmVkIiwiaW5mb3dpbmRvdyIsImNsb3NlIiwiZ29vZ2xlIiwibWFwcyIsIkluZm9XaW5kb3ciLCJjb250ZW50IiwibWF4V2lkdGgiLCJvcGVuIiwiYWRkQm91bmNlVGltZW91dCIsImdldEFuaW1hdGlvbiIsInNldEFuaW1hdGlvbiIsIkFuaW1hdGlvbiIsIkJPVU5DRSIsInNldFRpbWVvdXQiLCJhY3RpdmF0ZU1hcmtlciIsInBhblRvIiwibGF0IiwibG9jYXRpb24iLCJsbmciLCJyZXNldE1hcmtlcnMiLCJnZXRCb3QiLCJ0aXRsZSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJ0ZXh0Q29udGVudCIsIiQiLCJhamF4IiwidXJsIiwidHlwZSIsImRhdGEiLCJkYXRhVHlwZSIsInN1Y2Nlc3MiLCJzcmMiLCJpbWFnZVVybCIsImlubmVySFRNTCIsImVycm9yIiwiZXJyIiwiYWxlcnQiLCJzdGF0dXNUZXh0IiwiYmVmb3JlU2VuZCIsInhociIsInNldFJlcXVlc3RIZWFkZXIiLCJnZXRPcmlnIiwiY29uc29sZSIsImxvZyIsInF1ZXJ5U2VsZWN0b3IiLCJnb29nbGVTdWNjZXNzIiwiaW5pdE1hcCIsImtvIiwiYXBwbHlCaW5kaW5ncyIsIlZpZXdNb2RlbCIsImdvb2dsZUxvYWRFcnJvciIsImxvY2FsT3JiZSIsImNhdGVnb3J5IiwiZm91cklEIiwiaW1nU3JjIiwiUG9pIiwianNvbiIsInNlbGYiLCJ0aGlzIiwib2JzZXJ2YWJsZSIsIm1hcE1hcmtlciIsIk1hcmtlciIsInBvc2l0aW9uIiwiYW5pbWF0aW9uIiwiRFJPUCIsImFkZExpc3RlbmVyIiwiT1JCRSIsIk1hcCIsImNlbnRlciIsInpvb20iLCJsb2NhdGlvbkxpc3QiLCJvYnNlcnZhYmxlQXJyYXkiLCJzZWFyY2hOYW1lIiwiZm9yRWFjaCIsInB1c2giLCJmb3VySW5mbyIsIk9BVVRIX1RPS0VOIiwiYmFzZVVSTCIsInJlc3BvbnNlIiwidmVudWUiLCJzaG9ydFVybCIsImV4cGxvcmVVUkwiLCJnZXRKU09OIiwiZG9uZSIsImdvdEpTT04iLCJncm91cHMiLCJpdGVtcyIsInJlc3VsdHMiLCJpIiwibGVuZ3RoIiwiaXRlbSIsImNhdGVnb3JpZXMiLCJzaG9ydE5hbWUiLCJpZCIsImhhc093blByb3BlcnR5IiwiZmVhdHVyZWRQaG90b3MiLCJwcmVmaXgiLCJzdWZmaXgiLCJ0aXBzIiwidGV4dCIsImZhaWwiLCJqcXhociIsInRleHRTdGF0dXMiLCJjdXJyZW50UG9pIiwic2VhcmNoUmVzdWx0cyIsImNvbXB1dGVkIiwic2VhcmNoIiwidG9Mb3dlckNhc2UiLCJ1dGlscyIsImFycmF5RmlsdGVyIiwiaW5kZXhPZiIsInNldFZpc2libGUiLCJzZXRDdXJyZW50UG9pIl0sIm1hcHBpbmdzIjoiQUE0SEEsUUFBU0EsZUFBY0MsRUFBS0MsRUFBUUMsR0FDbEMsR0FDSUMsSUFET0QsRUFBSUUsV0FDSyx3RUFDc0NGLEVBQUlFLFdBQWEsK0tBS3pCRixFQUFJRyxPQUFTLG9DQUVsREgsRUFBSUcsT0FBUyxTQUFXSCxFQUFJSSxVQUFZLDRCQUN6QkosRUFBSUssVUFBWSxtREFLekJDLFVBQWZDLFlBQTBCQSxXQUFXQyxRQUN6Q0QsV0FBYSxHQUFJRSxRQUFPQyxLQUFLQyxZQUMzQkMsUUFBU1gsRUFDVFksU0FBVSxNQUVaTixXQUFXTyxLQUFLaEIsRUFBS0MsRUFBUUMsR0FHL0IsUUFBU2Usa0JBQWlCaEIsR0FDTSxPQUExQkEsRUFBT2lCLGVBQ1RqQixFQUFPa0IsYUFBYSxPQUVwQmxCLEVBQU9rQixhQUFhUixPQUFPQyxLQUFLUSxVQUFVQyxRQUMxQ0MsV0FBVyxXQUNUckIsRUFBT2tCLGFBQWEsT0FDbkIsT0FLUCxRQUFTSSxnQkFBZXZCLEVBQUtDLEVBQVFDLEdBQ25DRixFQUFJd0IsT0FD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Q0FBc0M4QixFQUFRSSxHQUFHVCxNQUFNWSxXQUFXLEdBQUdDLFVBRWpGUixFQUFRSSxHQUFHTSxlQUFlLFFBQzVCSixFQUFLOUYsUUFBVXdGLEVBQVFJLEdBQUdVLEtBQUssR0FBR0MsS0FFbENULEVBQUs5RixRQUFVLG9CQUVqQjJGLEVBQVFiLEtBQUtnQixHQUdmSCxFQUFRZCxRQUFRLFNBQVNqQixHQUN2QkMsRUFBS2EsYUFBYUksS0FBSyxHQUFJbkIsS0FBSUMsUUFHbEM0QyxLQUFLLFNBQVNDLEVBQU9DLEVBQVlwRSxHQUNoQyxHQUFJQyxHQUFNbUUsRUFBYSxLQUFPcEUsQ0FDOUJFLE9BQU0sK0NBQWlERCxLQUkzRHNCLEVBQUs4QyxXQUFheEQsR0FBR1ksV0FBV0QsS0FBS1ksZUFBZSxHQUFHM0UsUUFDdkQrQyxRQUFRQyxJQUFJYyxFQUFLOEMsY0FTakI5QyxFQUFLK0MsY0FBZ0J6RCxHQUFHMEQsU0FBUyxXQUMvQixHQUFJbEIsTUFFQW1CLEVBQVNqRCxFQUFLZSxhQUFhbUMsYUFFL0IsT0FBTzVELElBQUc2RCxNQUFNQyxZQUFZcEQsRUFBS2EsZUFBZ0IsU0FBUzlFLEdBQ3hELE1BQUlBLEdBQUlHLE9BQU9nSCxjQUFjRyxRQUFRSixJQUFXLEdBQzlDbkIsRUFBUWIsS0FBS2xGLEdBQ2IwQixlQUVBMUIsRUFBSW9FLFVBQVVtRCxZQUFXLEdBQ2xCeEIsT0FHUC9GLEdBQUlvRSxVQUFVbUQsWUFBVyxPQU0vQnRELEVBQUt1RCxjQUFnQixTQUFTeEgsR0FDNUJxQixlQUFldkIsSUFBS0UsRUFBSW9FLFVBQVdwRSxHQUNuQ2lFLEVBQUs4QyxXQUFXL0csRUFBSUcsVUFlcEJ1RCxnQkFBa0IsV0FDcEJkLE1BQU0iLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qID09PT09PT0gTW9kZWwgPT09PT09PSAqL1xuLy8ganNvbiBkYXRhIGZvciBwbGFjZXMgaW4gT3JiZVxuLyogPT09PT09PSA9PT09PSA9PT09PT09ICovXG5cbnZhciBsb2NhbE9yYmUgPSBbe1xuICBcIm5hbWVcIjogXCJMYSBUb3VyIFJvbmRlXCIsXG4gIFwibG9jYXRpb25cIjoge1xuICAgIFwibGF0XCI6IDQ2LjcyNTIyOCxcbiAgICBcImxuZ1wiOiA2LjUzMjY1MVxuICB9LFxuICBcImNhdGVnb3J5XCI6IFwiSGlzdG9yaWMgU2l0ZVwiLFxuICBcImZvdXJJRFwiOiBcIjU3NDlkMGQ3NDk4ZWVhYWRjNTNkMWE5NFwiLFxuICBcImltZ1NyY1wiOiBcImh0dHBzOi8vc3RhdGljLnBhbm9yYW1pby5jb20uc3RvcmFnZS5nb29nbGVhcGlzLmNvbS9waG90b3Mvc21hbGwvNTU2NjgwMDkuanBnXCIsXG4gIFwic25pcHBldFwiOiBcIlRoZSBSb3VuZCBUb3dlciBpcyBwYXJ0IG9mIHRoZSB0b3duJ3MgYW5jaWVudCBjYXN0bGUuIEl0IG9mZmVycyBzcGxlbmRpZCAzNjDCsCBwYW5vcmFtaWMgdmlld3Mgb3ZlciB0aGUgdG93biwgdGhlIEp1cmEgbW91bnRhaW4gcmFuZ2UsIGFuZCB0aGUgQWxwcy5cIlxufSwge1xuICBcIm5hbWVcIjogXCJRdWFydGllciBkZXMgVmlldXggTW91bGluc1wiLFxuICBcImxvY2F0aW9uXCI6IHtcbiAgICBcImxhdFwiOiA0Ni43MjA5MjYsXG4gICAgXCJsbmdcIjogNi41MzI0NjdcbiAgfSxcbiAgXCJjYXRlZ29yeVwiOiBcIlNjZW5pYyBMb29rb3V0XCIsXG4gIFwiZm91cklEXCI6IFwiNTc1ZWU0ZmU0OThlMzJiZmZlM2IyMDFmXCIsXG4gIFwiaW1nU3JjXCI6IFwiaHR0cHM6Ly9zdGF0aWMucGFub3JhbWlvLmNvbS5zdG9yYWdlLmdvb2dsZWFwaXMuY29tL3Bob3Rvcy9zbWFsbC83NDkyMDQ1NS5qcGdcIixcbiAgXCJzbmlwcGV0XCI6IFwiVGhlIGFuY2llbnQgZmxvdXJtaWxscyBkYXRlIGJhY2sgdG8gMTQyMyBhbmQgd2VyZSBpbiB1c2UgdW50aWwgdGhlIHZlcnkgZW5kIG9mIHRoZSAxOTkwcy5cIlxufSwge1xuICBcIm5hbWVcIjogXCJMZXMgR29yZ2VzIGRlIGwnT3JiZVwiLFxuICBcImxvY2F0aW9uXCI6IHtcbiAgICBcImxhdFwiOiA0Ni43Mjc1MzYsXG4gICAgXCJsbmdcIjogNi41MDkxMTBcbiAgfSxcbiAgXCJjYXRlZ29yeVwiOiBcIlRyYWlsXCIsXG4gIFwiZm91cklEXCI6IFwiNGRmZGQ3MWVjNjViMzE1NzliMzMwZjQwXCIsXG4gIFwiaW1nU3JjXCI6IFwiaHR0cHM6Ly9zdGF0aWMucGFub3JhbWlvLmNvbS5zdG9yYWdlLmdvb2dsZWFwaXMuY29tL3Bob3Rvcy9zbWFsbC81NTY2Nzc0NS5qcGdcIixcbiAgXCJzbmlwcGV0XCI6IFwiQSB3YWxrIHRocm91Z2ggdGhlIGdvcmdlcyBvZiB0aGUgUml2ZXIgT3JiZSBwcmVzZW50cyBoaWtlcnMgd2l0aCBhIHdlYWx0aCBvZiBuYXR1cmFsIHJlc291cmNlcyBpbiB0aGUgZm9vdGhpbGxzIG9mIHRoZSBKdXJhIE1vdW50YWlucywgYmV0d2VlbiBWYWxsb3JiZSBhbmQgT3JiZS5cIlxufSwge1xuICBcIm5hbWVcIjogXCJNdXIgZCdlc2NhbGFkZSwgQ2hhdm9ybmF5XCIsXG4gIFwibG9jYXRpb25cIjoge1xuICAgIFwibGF0XCI6IDQ2LjcwNzY5LFxuICAgIFwibG5nXCI6IDYuNTY2ODcxXG4gIH0sXG4gIFwiY2F0ZWdvcnlcIjogXCJDbGltYmluZyBHeW1cIixcbiAgXCJmb3VySURcIjogXCI0Yzc0NTk2ZTFiMzBhMDkzYzM4MGVjMDlcIixcbiAgXCJpbWdTcmNcIjogXCJodHRwczovL2lyczAuNHNxaS5uZXQvaW1nL2dlbmVyYWwvd2lkdGg5NjAvMzE1MjM5X3ZGQ3Q2XzB5eVFKdEgycTdMcUg5M0ZLWU1JOHlaVWZOdnJwU3QxalZ2RFkuanBnXCIsXG4gIFwic25pcHBldFwiOiBcIlRoZSBjbGltYmluZyB3YWxsIGF0IENoYXZvcm5heSBpcyBkaXZpZGVkIGludG8gZml2ZSBzZXBhcmF0ZSB6b25lcywgaW5jbHVkaW5nIGJvdWxkZXJpbmcsIGNoaWxkcmVuJ3MgYXJlYSBhbmQgbGVhZCB3YWxscy5cIlxufSwge1xuICBcIm5hbWVcIjogXCJPcmJlIMOgIHBldGl0cyBwYXNcIixcbiAgXCJsb2NhdGlvblwiOiB7XG4gICAgXCJsYXRcIjogNDYuNzIzMTY4LFxuICAgIFwibG5nXCI6IDYuNTI5NTcwXG4gIH0sXG4gIFwiY2F0ZWdvcnlcIjogXCJUcmFpbFwiLFxuICBcImZvdXJJRFwiOiBcIjRmNzg2YTUyZTRiMDU1Yzc2MThjMTU3ZVwiLFxuICBcImltZ1NyY1wiOiBcImh0dHBzOi8vc3RhdGljLnBhbm9yYW1pby5jb20uc3RvcmFnZS5nb29nbGVhcGlzLmNvbS9waG90b3Mvc21hbGwvMjA0Njg2OTIuanBnXCIsXG4gIFwic25pcHBldFwiOiBcIlR3byBlYXN5IHdhbGtzLCBtYXJrZWQgd2l0aCB5ZWxsb3cgYW5kIHJlZCBzdGVwcyBvbiB0aGUgZ3JvdW5kLCBndWlkZSB5b3UgYXJvdW5kIHRoZSB0b3duLCBpdHMgc3Vycm91bmRpbmdzLCBhbmQgdGhlIHJpdmVyLlwiXG59XTtcblxuLyogPT09PT09PSBsaXN0IFZpZXcgPT09PT09PSAqL1xuLy8gUG9pKCkgUG9pbnQgb2YgSW50ZXJlc3Rcbi8vIG9ic2VydmFibGVzOlxuLy8gUG9pLm5hbWVcbi8vIFBvaS5sb2NhdGlvblxuLy8gUG9pLmNhdGVnb3J5XG4vLyBQb2kuaW1hZ2VTcmNcbi8vIFBvaS5mb3VySURcbi8vIFBvaS5mb3VyV2ViXG4vLyBQb2kuc25pcHBldFxuLyogPT09PT09PSA9PT09PT09PT0gPT09PT09PSAqL1xuXG4vLyBqc29uIGlzIGFuIG9iamVjdCBsaXRlcmFsIHRoYXQgY29udGFpbnMgbG9jYXRpb24gZGF0YSBmb3IgYSBzaW5nbGUgcG9pIGluIE9yYmVcbi8vIFBvaSBpcyBhbiBvYmplY3QgY29uc3R1Y3RvciBmb3IgYSBzaW5nbGUgcGxhY2Ugb2YgaW50ZXJlc3RcbnZhciBQb2kgPSBmdW5jdGlvbihqc29uKSB7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgc2VsZi5uYW1lID0ga28ub2JzZXJ2YWJsZShqc29uLm5hbWUpO1xuICBzZWxmLmxvY2F0aW9uID0ga28ub2JzZXJ2YWJsZShqc29uLmxvY2F0aW9uKTtcbiAgc2VsZi5jYXRlZ29yeSA9IGtvLm9ic2VydmFibGUoanNvbi5jYXRlZ29yeSk7XG4gIHNlbGYuZm91cklEID0ga28ub2JzZXJ2YWJsZShqc29uLmZvdXJJRCk7XG4gIHNlbGYuaW1hZ2VTcmMgPSBrby5vYnNlcnZhYmxlKGpzb24uaW1nU3JjKTtcbiAgc2VsZi5zbmlwcGV0ID0ga28ub2JzZXJ2YWJsZShqc29uLnNuaXBwZXQpO1xuICBzZWxmLmZvdXJXZWIgPSBrby5vYnNlcnZhYmxlKGpzb24uZm91cldlYik7XG4gIC8vIGF0dGFjaCB0aGUgbWFwIG1hcmtlciBmb3IgdGhpcyBQb2kgb2JqZWN0XG4gIHNlbGYubWFwTWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XG4gICAgcG9zaXRpb246IHtcbiAgICAgIGxhdDogc2VsZi5sb2NhdGlvbigpLmxhdCxcbiAgICAgIGxuZzogc2VsZi5sb2NhdGlvbigpLmxuZ1xuICAgIH0sXG4gICAgdGl0bGU6IHNlbGYubmFtZSgpLFxuICAgIGFuaW1hdGlvbjogZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkRST1AsXG4gICAgbWFwOiBtYXBcbiAgfSk7XG4gIC8vICBhZGQgY2xpY2sgaGFuZGxlciB0byBtYXJrZXJcbiAgc2VsZi5tYXBNYXJrZXIuYWRkTGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgYWN0aXZhdGVNYXJrZXIobWFwLCBzZWxmLm1hcE1hcmtlciwgc2VsZik7XG4gIH0pO1xufTtcblxuXG4vKiA9PT09PT09IEdvb2dsZSBNYXBzID09PT09PT0gKi9cbi8vIG1hcCwgaW5mb3dpbmRvd1xuLy8gaW5pdE1hcCgpXG4vLyBzZXRJbmZvV2luZG93KG1hcCwgbWFya2VyLCBwb2kpXG4vLyBhZGRCb3VuY2VUaW1lb3V0KG1hcmtlcilcbi8vIGFjdGl2YXRlTWFya2VyKG1hcCwgbWFya2VyLCBwb2kpXG4vLyByZXNldE1hcmtlcnMoKVxuLy8gZ2V0Qm90KClcbi8vIGdldE9yaWcoaW1hZ2VTcmMpXG4vKiA9PT09PT09ID09PT09PT09PT09ID09PT09PT0gKi9cblxuLy8gc2ltcGxlIG1hcCBleGFtcGxlIGZyb20gZ29vZ2xlIGFwaVxudmFyIG1hcDtcbnZhciBpbml0TWFwID0gZnVuY3Rpb24oKSB7XG4gIHZhciBPUkJFID0ge1xuICAgIGxhdDogNDYuNzI0MjU4LFxuICAgIGxuZzogNi41MzIwNjRcbiAgfTtcbiAgbWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLWNhbnZhcycpLCB7XG4gICAgY2VudGVyOiBPUkJFLFxuICAgIHpvb206IDEzXG4gIH0pO1xufTtcblxuLy8gYWRkIHNpbXBsZSBpbmZvIHdpbmRvdyB0byBwb2kgbWFya2VyXG4vLyBvbmx5IHdhbnQgb25lIGluZm8gd2luZG93IG9wZW4gYXQgYSB0aW1lLiB1c2UgZ2xvYmFsIHRvIGtlZXAgdHJhY2sgb2YgZXhpc3Rpbmcgd2luZG93XG52YXIgaW5mb3dpbmRvdztcblxuZnVuY3Rpb24gc2V0SW5mb1dpbmRvdyhtYXAsIG1hcmtlciwgcG9pKSB7XG4gIHZhciBvcmlnID0gcG9pLmltYWdlU3JjKCk7XG4gIHZhciBjb250ZW50U3RyaW5nID0gJzxkaXYgaWQ9XCJjb250ZW50XCI+JyArXG4gICAgJzxkaXY+PGltZyBpZD1cIm9yYm90XCIgd2lkdGg9XCIyMDBcIiBoZWlnaHQ9XCIxNTBcIiBzcmM9XCInICsgcG9pLmltYWdlU3JjKCkgKyAnXCI+PC9kaXY+JyArXG4gICAgJzxkaXYgY2xhc3M9XCJvcmJvdFwiPjxidXR0b24gY2xhc3M9XCJidG4tZGFuZ2VyXCIgb25jbGljaz1cImdldEJvdCgpXCI+T3Jib3QuLi4gMyAyIDE8L2J1dHRvbj4nICtcbiAgICAnPHAgaWQ9XCJhdHRyaWJ1dGVSb2JvdFwiPjwvcD4nICtcbiAgICAvLyc8YnV0dG9uIGNsYXNzPVwiYnRuLXN1Y2Nlc3NcIiBvbmNsaWNrPVwiZ2V0T3JpZygnKyBvcmlnICsnKVwiPldob2EuLi4gVW5kbyEhPC9idXR0b24+JyArXG4gICAgJzwvZGl2PicgK1xuICAgICc8aDQgaWQ9XCJmaXJzdEhlYWRpbmdcIiBjbGFzcz1cImZpcnN0SGVhZGluZ1wiPicgKyBwb2kubmFtZSgpICsgJzwvaDQ+JyArXG4gICAgJzxkaXYgaWQ9XCJib2R5Q29udGVudFwiPicgK1xuICAgICc8cD48Yj4nICsgcG9pLm5hbWUoKSArICc8L2I+LiAnICsgcG9pLnNuaXBwZXQoKSArICc8L3A+JyArXG4gICAgJzxwPiBWaWV3IG9uIDxhIGhyZWY9XCInICsgcG9pLmZvdXJXZWIoKSArICdcIiB0YXJnZXQ9XCJfYmxhbmtcIj5Gb3VyU3F1YXJlPC9hPjwvcD4nICtcbiAgICAnPC9kaXY+JyArXG4gICAgJzwvZGl2Pic7XG5cbiAgLy8gaWYgYW4gb3BlbiB3aW5kb3cgZXhpc3RzLCBjbG9zZSBpdCBiZWZvcmUgbWFraW5nIG5ldyBvbmVcbiAgaWYgKGluZm93aW5kb3cgIT09IHVuZGVmaW5lZCkgaW5mb3dpbmRvdy5jbG9zZSgpO1xuICBpbmZvd2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coe1xuICAgIGNvbnRlbnQ6IGNvbnRlbnRTdHJpbmcsXG4gICAgbWF4V2lkdGg6IDIyMFxuICB9KTtcbiAgaW5mb3dpbmRvdy5vcGVuKG1hcCwgbWFya2VyLCBwb2kpO1xufVxuXG5mdW5jdGlvbiBhZGRCb3VuY2VUaW1lb3V0KG1hcmtlcikge1xuICBpZiAobWFya2VyLmdldEFuaW1hdGlvbigpICE9PSBudWxsKSB7XG4gICAgbWFya2VyLnNldEFuaW1hdGlvbihudWxsKTtcbiAgfSBlbHNlIHtcbiAgICBtYXJrZXIuc2V0QW5pbWF0aW9uKGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5CT1VOQ0UpO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICBtYXJrZXIuc2V0QW5pbWF0aW9uKG51bGwpO1xuICAgIH0sIDIxMDApO1xuICB9XG59XG5cbi8vIGdvb2dsZSBtYXBzIHBhblRvIG1ldGhvZCB1c2VkIHRvIGNoYW5nZSB0aGUgY2VudGVyIG9mIHRoZSBtYXAgdG8gdGhlIGdpdmVuIExhdExuZ1xuZnVuY3Rpb24gYWN0aXZhdGVNYXJrZXIobWFwLCBtYXJrZXIsIHBvaSkge1xuICBtYXAucGFuVG8oe1xuICAgIGxhdDogcG9pLmxvY2F0aW9uKCkubGF0LFxuICAgIGxuZzogcG9pLmxvY2F0aW9uKCkubG5nXG4gIH0pO1xuICBhZGRCb3VuY2VUaW1lb3V0KG1hcmtlcik7XG4gIHNldEluZm9XaW5kb3cobWFwLCBtYXJrZXIsIHBvaSk7XG59XG5cbmZ1bmN0aW9uIHJlc2V0TWFya2VycygpIHtcbiAgLy8gaWYgYW4gb3BlbiB3aW5kb3cgZXhpc3RzLCBjbG9zZSBpdFxuICBpZiAoaW5mb3dpbmRvdyAhPT0gdW5kZWZpbmVkKSBpbmZvd2luZG93LmNsb3NlKCk7XG59XG5cbmZ1bmN0aW9uIGdldEJvdCgpIHtcbiAgdmFyIHRpdGxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJmaXJzdEhlYWRpbmdcIikudGV4dENvbnRlbnQ7XG4gIHZhciBvdXRwdXQgPSAkLmFqYXgoe1xuICAgIHVybDogJ2h0dHBzOi8vcm9ib2hhc2gucC5tYXNoYXBlLmNvbS9pbmRleC5waHA/JywgLy8gVGhlIFVSTCB0byB0aGUgQVBJLiBZb3UgY2FuIGdldCB0aGlzIGJ5IGNsaWNraW5nIG9uIFwiU2hvdyBDVVJMIGV4YW1wbGVcIiBmcm9tIGFuIEFQSSBwcm9maWxlXG4gICAgdHlwZTogJ0dFVCcsIC8vIFRoZSBIVFRQIE1ldGhvZCwgY2FuIGJlIEdFVCBQT1NUIFBVVCBERUxFVEUgZXRjXG4gICAgZGF0YTogJ3RleHQ9JyArIHRpdGxlLCAvLyBBZGRpdGlvbmFsIHBhcmFtZXRlcnMgaGVyZVxuICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgc3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJvcmJvdFwiKS5zcmMgPSBkYXRhLmltYWdlVXJsO1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhdHRyaWJ1dGVSb2JvdFwiKS5pbm5lckhUTUwgPSBcIkZyaWVuZGx5IHJvYm90IGJ5IFJvYm9oYXNoLm9yZ1wiO1xuICAgIH0sXG4gICAgZXJyb3I6IGZ1bmN0aW9uKGVycikge1xuICAgICAgYWxlcnQoXCJEb2VzIG5vdCBjb21wdXRlLCBubyByb2JvdCByYW1wYWdlcyBhdCB0aGlzIHRpbWU6IFxcblwiICsgZXJyLnN0YXR1c1RleHQpO1xuICAgIH0sXG4gICAgYmVmb3JlU2VuZDogZnVuY3Rpb24oeGhyKSB7XG4gICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcIlgtTWFzaGFwZS1BdXRob3JpemF0aW9uXCIsIFwiVmdNR0ZObXB6N21zaEFOT0p1MXZ5b2pYeHRQU3AxRUpscWhqc25keTFlNjlWOGZyb1ZcIik7IC8vIEVudGVyIGhlcmUgeW91ciBNYXNoYXBlIGtleVxuICAgIH1cbiAgfSk7XG59XG5cbi8vIEkgY2Fubm90IGdldCBhIHJlc2V0IGJ1dHRvbiB0byB3b3JrIVxuLy8gdW5jb21tZW50IGxpbmUgYmVnIDxidXR0b24gY2xhc3M9XCJidG4tc3VjY2Vzc1wiIGluIHNldEluZm9XaW5kb3dcbi8vIGdldCB0aGlzIGVycm9yIG1lc3NhZ2U6XG4vLyBVbmNhdWdodCBTeW50YXhFcnJvcjogbWlzc2luZyApIGFmdGVyIGFyZ3VtZW50IGxpc3Rcbi8vID8/PyBzZWVtcyB0byByZWZlciB0byBpbmRleC5odG1sIDwhRE9DVFlQRSBodG1sPlxuZnVuY3Rpb24gZ2V0T3JpZyhpbWFnZVNyYykge1xuICBjb25zb2xlLmxvZyhpbWFnZVNyYyk7XG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjb3Jib3RcIikuc3JjID0gaW1hZ2VTcmM7XG59XG5cbi8qID09PT09PT0gVmlld01vZGVsID09PT09PT0gKi9cbi8vIFZpZXdNb2RlbCgpXG4vKiA9PT09PT09ID09PT09PT09PT09ID09PT09PT0gKi9cblxudmFyIFZpZXdNb2RlbCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIC8vIGNyZWF0ZSBhcnJheSBvZiBwbGFjZXNcbiAgc2VsZi5sb2NhdGlvbkxpc3QgPSBrby5vYnNlcnZhYmxlQXJyYXkoW10pO1xuICBzZWxmLnNlYXJjaE5hbWUgPSBrby5vYnNlcnZhYmxlKCcnKTtcblxuICAvLyBwYXNzIGxvY2FsT3JiZSBvYmplY3QgbGl0ZXJhbCBqc29uIGRhdGEgdG8gbmV3IFBvaVxuICAvLyBsb29wIG92ZXIgdGhlIGpzb24gYXJyYXkgYW5kIHB1c2ggZWFjaCBuZXcgcG9pIGludG8gbG9jYXRpb25MaXN0XG4gIC8vIHVzZSAnc2VsZicgdG8gYXZvaWQgJ3RoaXMnIGtleXdvcmQgc2NvcGUgY29uZnVzaW9uXG4gIGxvY2FsT3JiZS5mb3JFYWNoKGZ1bmN0aW9uKGpzb24pIHtcbiAgICBzZWxmLmxvY2F0aW9uTGlzdC5wdXNoKG5ldyBQb2koanNvbikpO1xuICB9KTtcblxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy8gRm91clNxdWFyZSBBUElcbiAgLy8gaHR0cHM6Ly9hcGkuZm91cnNxdWFyZS5jb20vdjIvdmVudWVzL2V4cGxvcmVcbiAgLy8gaHR0cHM6Ly9hcGkuZm91cnNxdWFyZS5jb20vdjIvdmVudWVzL1ZFTlVFX0lEXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIC8vIGFkZCBkZXRhaWwgdG8gaGFyZGNvZGVkXG4gIC8vIEZvciBlYWNoIHBvaSBpbiBsb2NhdGlvbkxpc3QsIHJlcXVlc3QgRm91cnNxdWFyZSBkYXRhIGZvciB0aGUgaW5mb3dpbmRvd1xuICB2YXIgZm91ckluZm8gPSB7XG4gICAgT0FVVEhfVE9LRU46ICdMT0oyRFVSQTRLREUzSElPWkgxVFAwTkFFUDFYR0lGTFFQMEZWQUUyTEhZRkZLTFInLFxuICAgIGJhc2VVUkw6ICdodHRwczovL2FwaS5mb3Vyc3F1YXJlLmNvbS92Mi92ZW51ZXMvJ1xuICB9O1xuXG4gIC8vIG1ha2UgQWpheCByZXF1ZXN0IG9uIFZFTlVFX0lEIHRvIGFkZCBsaW5rIHN1cHBsaWVkIGJ5IGZvdXJzcXVhcmUgdG8gZWFjaCBleGlzdGluZyBwb2lcbiAgc2VsZi5sb2NhdGlvbkxpc3QoKS5mb3JFYWNoKGZ1bmN0aW9uKHBvaSkge1xuICAgICQuYWpheCh7XG4gICAgICB1cmw6IGZvdXJJbmZvLmJhc2VVUkwgKyBwb2kuZm91cklEKCksXG4gICAgICBkYXRhVHlwZTogJ2pzb24nLFxuICAgICAgZGF0YTogJ29hdXRoX3Rva2VuPScgKyBmb3VySW5mby5PQVVUSF9UT0tFTiArXG4gICAgICAgICcmdj0yMDE2MDYxMycsXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIHBvaS5mb3VyV2ViKGRhdGEucmVzcG9uc2UudmVudWUuc2hvcnRVcmwpO1xuICAgICAgfSxcbiAgICAgIGVycm9yOiBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgYWxlcnQoXCJSZXF1ZXN0ZWQgRm91clNxdWFyZSBkYXRhIGZhaWxlZCB0byBsb2FkOiBcXG5cIiArIGVyci5zdGF0dXNUZXh0KTtcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0pO1xuXG4gIC8vIGV4YW1wbGUgb2YgY2FsbCB0byBleHBsb3JlXG4gIC8vIGh0dHBzOi8vYXBpLmZvdXJzcXVhcmUuY29tL3YyL3ZlbnVlcy9leHBsb3JlP2xsPTQwLjcsLTc0Jm9hdXRoX3Rva2VuPUxPSjJEVVJBNEtERTNISU9aSDFUUDBOQUVQMVhHSUZMUVAwRlZBRTJMSFlGRktMUiZ2PTIwMTYwNjE1XG4gIC8vIGJhc2VkIG9uIGpzb24gb3V0cHV0IHdhbnQgdG8gbmFycm93IGluIG9uOiBkYXRhLnJlc3BvbnNlLmdyb3Vwc1swXS5pdGVtc1xuICAvLyB0aGVuIGRyaWxsIGRvd24gdG86XG4gIC8vIHZlbnVlLmlkIHZlbnVlLm5hbWVcbiAgLy8gdmVudWUubG9jYXRpb24ubGF0IHZlbnVlLmxvY2F0aW9uLmxuZ1xuICAvLyB2ZW51ZS5mZWF0dXJlZFBob3Rvcy5pdGVtc1swXS5wcmVmaXggLnN1ZmZpeCAgLmlkIC8vIGNhbiBub3QgYmUgcmVsaWVkIHVwb24gYXMgZmVhdHVyZWRQaG90b3MgbXkgbm90IGV4aXN0XG4gIC8vIHRpcHNbMF0uY2Fub25pY2FsVXJsIHRpcHNbMF0udGV4dCAvLyBjYW4gbm90IGJlIHJlbGllZCB1cG9uIGFzIHRpcHMgbXkgbm90IGV4aXN0XG5cbiAgLy8gU3RlcCAxOiBHZXQgdGhlIHJlc3VsdHNcbiAgdmFyIGV4cGxvcmVVUkwgPSBmb3VySW5mby5iYXNlVVJMICtcbiAgICAnZXhwbG9yZT9sbD00Ni43MjQyNTgsNi41MzIwNjQmcmFkaXVzPTUwMDAmbGltaXQ9NSZ2ZW51ZVBob3Rvcz0xJyArXG4gICAgJyZzZWN0aW9uPWNvZmZlZScgK1xuICAgICcmbW9kZT11cmwnICtcbiAgICAnJm9hdXRoX3Rva2VuPScgKyBmb3VySW5mby5PQVVUSF9UT0tFTiArXG4gICAgJyZ2PTIwMTYwNjE1JztcblxuICAkLmdldEpTT04oZXhwbG9yZVVSTClcbiAgICAuZG9uZShmdW5jdGlvbihkYXRhKSB7XG4gICAgICB2YXIgZ290SlNPTiA9IGRhdGEucmVzcG9uc2UuZ3JvdXBzWzBdLml0ZW1zO1xuICAgICAgLy8gU3RlcCAyOiBQcm9jZXNzIHRoZSByZXN1bHRzIGludG8gdGhlIGZvcm0geW91IHdhbnRcbiAgICAgIHZhciByZXN1bHRzID0gW107XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGdvdEpTT04ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGl0ZW0gPSB7XG4gICAgICAgICAgXCJuYW1lXCI6IGdvdEpTT05baV0udmVudWUubmFtZSxcbiAgICAgICAgICBcImxvY2F0aW9uXCI6IHtcbiAgICAgICAgICAgIFwibGF0XCI6IGdvdEpTT05baV0udmVudWUubG9jYXRpb24ubGF0LFxuICAgICAgICAgICAgXCJsbmdcIjogZ290SlNPTltpXS52ZW51ZS5sb2NhdGlvbi5sbmdcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiY2F0ZWdvcnlcIjogZ290SlNPTltpXS52ZW51ZS5jYXRlZ29yaWVzWzBdLnNob3J0TmFtZSxcbiAgICAgICAgICBcImZvdXJJRFwiOiBnb3RKU09OW2ldLnZlbnVlLmlkLFxuICAgICAgICAgIFwiZm91cldlYlwiOiBcImh0dHBzOi8vZm91cnNxdWFyZS5jb20vdi9cIiArIGdvdEpTT05baV0udmVudWUuaWRcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKGdvdEpTT05baV0udmVudWUuaGFzT3duUHJvcGVydHkoJ2ZlYXR1cmVkUGhvdG9zJykpIHtcbiAgICAgICAgICBpdGVtLmltZ1NyYyA9IGdvdEpTT05baV0udmVudWUuZmVhdHVyZWRQaG90b3MuaXRlbXNbMF0ucHJlZml4ICsgJzIwMHgxNTAnICsgZ290SlNPTltpXS52ZW51ZS5mZWF0dXJlZFBob3Rvcy5pdGVtc1swXS5zdWZmaXg7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaXRlbS5pbWdTcmMgPSBcImh0dHA6Ly9wbGFjZWhvbGQuaXQvMjAweDE1MD90ZXh0PVwiICsgZ290SlNPTltpXS52ZW51ZS5jYXRlZ29yaWVzWzBdLnNob3J0TmFtZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZ290SlNPTltpXS5oYXNPd25Qcm9wZXJ0eSgndGlwcycpKSB7XG4gICAgICAgICAgaXRlbS5zbmlwcGV0ID0gZ290SlNPTltpXS50aXBzWzBdLnRleHQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaXRlbS5zbmlwcGV0ID0gXCJObyByZXZpZXdzIHlldC4uLlwiO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdHMucHVzaChpdGVtKTtcbiAgICAgIH1cbiAgICAgIC8vIGRvIG90aGVyIHdvcmsgd2l0aCB5b3VyIHJlc3VsdHMgYmVsb3cgaGVyZVxuICAgICAgcmVzdWx0cy5mb3JFYWNoKGZ1bmN0aW9uKGpzb24pIHtcbiAgICAgICAgc2VsZi5sb2NhdGlvbkxpc3QucHVzaChuZXcgUG9pKGpzb24pKTtcbiAgICAgIH0pO1xuICAgIH0pXG4gICAgLmZhaWwoZnVuY3Rpb24oanF4aHIsIHRleHRTdGF0dXMsIGVycm9yKSB7XG4gICAgICB2YXIgZXJyID0gdGV4dFN0YXR1cyArIFwiLCBcIiArIGVycm9yO1xuICAgICAgYWxlcnQoXCJSZXF1ZXN0ZWQgRm91clNxdWFyZSBkYXRhIGZhaWxlZCB0byBsb2FkOiBcXG5cIiArIGVycik7XG4gICAgfSk7XG5cbiAgLy8gdXNlIGZpcnN0IHBvaSBpbiBPcmJlIHRvIHRlc3Qgc2VsZWN0ZWQgcGxhY2VcbiAgc2VsZi5jdXJyZW50UG9pID0ga28ub2JzZXJ2YWJsZSh0aGlzLmxvY2F0aW9uTGlzdCgpWzBdLm5hbWUoKSk7XG4gIGNvbnNvbGUubG9nKHNlbGYuY3VycmVudFBvaSgpKTtcblxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy8gc2VhcmNoIHNlY3Rpb25cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gZGF0YS1iaW5kIHNlYXJjaE5hbWUgdG8gdGhlIGZvcm0gaW5wdXQgaW4gbGVmdCBuYXYgLSB2YWx1ZTogc2VhcmNoTmFtZVxuICAvLyBkYXRhLWJpbmQgdG8gdXBkYXRlIG9uIG5ldyBsZXR0ZXIgLSB2YWx1ZVVwZGF0ZTogJ2FmdGVya2V5ZG93bidcbiAgLy8gc2V0VmlzaWJsZSBpcyBhIG1ldGhvZCBvbiBnb29nbGUgbWFya2VyXG4gIHNlbGYuc2VhcmNoUmVzdWx0cyA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgIHZhciByZXN1bHRzID0gW107XG4gICAgLy8gdXNlIHZhbHVlIGluIHNlYXJjaCBib3hcbiAgICB2YXIgc2VhcmNoID0gc2VsZi5zZWFyY2hOYW1lKCkudG9Mb3dlckNhc2UoKTtcbiAgICAvLyBzdHJpbmcgbWF0Y2ggZm9yIGVhY2ggcG9pLm5hbWUgaW4gdGhlIGxvY2F0aW9uIGxpc3RcbiAgICByZXR1cm4ga28udXRpbHMuYXJyYXlGaWx0ZXIoc2VsZi5sb2NhdGlvbkxpc3QoKSwgZnVuY3Rpb24ocG9pKSB7XG4gICAgICBpZiAocG9pLm5hbWUoKS50b0xvd2VyQ2FzZSgpLmluZGV4T2Yoc2VhcmNoKSA+PSAwKSB7XG4gICAgICAgIHJlc3VsdHMucHVzaChwb2kpO1xuICAgICAgICByZXNldE1hcmtlcnMoKTtcbiAgICAgICAgLy8gc2hvdyBtYXJrZXJcbiAgICAgICAgcG9pLm1hcE1hcmtlci5zZXRWaXNpYmxlKHRydWUpO1xuICAgICAgICByZXR1cm4gcmVzdWx0cztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGhpZGUgbWFya2VyXG4gICAgICAgIHBvaS5tYXBNYXJrZXIuc2V0VmlzaWJsZShmYWxzZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIC8vIGNsaWNrIG9uIGxpc3QgaXRlbVxuICBzZWxmLnNldEN1cnJlbnRQb2kgPSBmdW5jdGlvbihwb2kpIHtcbiAgICBhY3RpdmF0ZU1hcmtlcihtYXAsIHBvaS5tYXBNYXJrZXIsIHBvaSk7XG4gICAgc2VsZi5jdXJyZW50UG9pKHBvaS5uYW1lKCkpO1xuICB9O1xufTtcblxuLy8gSWYgY2FsbCB0byBnb29nbGUgbWFwcyBhcGkgc3VjY2Vzc2Z1bCBjcmVhdGUgdmlld21vZGVsIGFuZCBhcHBseSBiaW5kaW5nc1xuZnVuY3Rpb24gZ29vZ2xlU3VjY2VzcygpIHtcbiAgaWYgKHR5cGVvZiBnb29nbGUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgaW5pdE1hcCgpO1xuICAgIGtvLmFwcGx5QmluZGluZ3MobmV3IFZpZXdNb2RlbCgpKTtcbiAgfSBlbHNlIHtcbiAgICBnb29nbGVMb2FkRXJyb3IoKTtcbiAgfVxufVxuXG4vLyBFcnJvciBoYW5kbGluZyBmb3IgdGhlIEdvb2dsZSBNYXBzXG52YXIgZ29vZ2xlTG9hZEVycm9yID0gZnVuY3Rpb24oKSB7XG4gIGFsZXJ0KCdHb29nbGUgbWFwcyBsb2FkIGVycm9yJyk7XG59O1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
