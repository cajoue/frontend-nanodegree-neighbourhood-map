function setInfoWindow(e,o,t){var a=(t.imageSrc(),'<div id="content"><div><img id="orbot" width="200" height="150" src="'+t.imageSrc()+'"></div><div class="orbot"><button class="btn-danger" onclick="getBot()">Orbot... 3 2 1</button><p id="attributeRobot"></p></div><h4 id="firstHeading" class="firstHeading">'+t.name()+'</h4><div id="bodyContent"><p><b>'+t.name()+"</b>. "+t.snippet()+'</p><p> View on <a href="'+t.fourWeb()+'" target="_blank">FourSquare</a></p></div></div>');void 0!==infowindow&&infowindow.close(),infowindow=new google.maps.InfoWindow({content:a,maxWidth:220}),infowindow.open(e,o,t)}function addBounceTimeout(e){null!==e.getAnimation()?e.setAnimation(null):(e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},2100))}function activateMarker(e,o,t){e.panTo({lat:t.location().lat,lng:t.location().lng}),addBounceTimeout(o),setInfoWindow(e,o,t)}function resetMarkers(){void 0!==infowindow&&infowindow.close()}function getBot(){var e=document.getElementById("firstHeading").textContent;$.ajax({url:"https://robohash.p.mashape.com/index.php?",type:"GET",data:"text="+e,dataType:"json",success:function(e){document.querySelector("#orbot").src=e.imageUrl,document.querySelector("#attributeRobot").innerHTML="Friendly robot by Robohash.org"},error:function(e){alert("Does not compute, no robot rampages at this time: \n"+e.statusText)},beforeSend:function(e){e.setRequestHeader("X-Mashape-Authorization","VgMGFNmpz7mshANOJu1vyojXxtPSp1EJlqhjsndy1e69V8froV")}})}function getOrig(e){console.log(e),document.querySelector("#orbot").src=e}function googleSuccess(){"undefined"!=typeof google?(initMap(),ko.applyBindings(new ViewModel)):googleLoadError()}var localOrbe=[{name:"La Tour Ronde",location:{lat:46.725228,lng:6.532651},category:"Historic Site",fourID:"5749d0d7498eeaadc53d1a94",imgSrc:"https://static.panoramio.com.storage.googleapis.com/photos/small/55668009.jpg",snippet:"The Round Tower is part of the town's ancient castle. It offers splendid 360° panoramic views over the town, the Jura mountain range, and the Alps."},{name:"Quartier des Vieux Moulins",location:{lat:46.720926,lng:6.532467},category:"Scenic Lookout",fourID:"575ee4fe498e32bffe3b201f",imgSrc:"https://static.panoramio.com.storage.googleapis.com/photos/small/74920455.jpg",snippet:"The ancient flourmills date back to 1423 and were in use until the very end of the 1990s."},{name:"Les Gorges de l'Orbe",location:{lat:46.727536,lng:6.50911},category:"Trail",fourID:"4dfdd71ec65b31579b330f40",imgSrc:"https://static.panoramio.com.storage.googleapis.com/photos/small/55667745.jpg",snippet:"A walk through the gorges of the River Orbe presents hikers with a wealth of natural resources in the foothills of the Jura Mountains, between Vallorbe and Orbe."},{name:"Mur d'escalade, Chavornay",location:{lat:46.70769,lng:6.566871},category:"Climbing Gym",fourID:"4c74596e1b30a093c380ec09",imgSrc:"https://irs0.4sqi.net/img/general/width960/315239_vFCt6_0yyQJtH2q7LqH93FKYMI8yZUfNvrpSt1jVvDY.jpg",snippet:"The climbing wall at Chavornay is divided into five separate zones, including bouldering, children's area and lead walls."},{name:"Orbe à petits pas",location:{lat:46.723168,lng:6.52957},category:"Trail",fourID:"4f786a52e4b055c7618c157e",imgSrc:"https://static.panoramio.com.storage.googleapis.com/photos/small/20468692.jpg",snippet:"Two easy walks, marked with yellow and red steps on the ground, guide you around the town, its surroundings, and the river."}],Poi=function(e){var o=this;o.name=ko.observable(e.name),o.location=ko.observable(e.location),o.category=ko.observable(e.category),o.fourID=ko.observable(e.fourID),o.imageSrc=ko.observable(e.imgSrc),o.snippet=ko.observable(e.snippet),o.fourWeb=ko.observable(e.fourWeb),o.mapMarker=new google.maps.Marker({position:{lat:o.location().lat,lng:o.location().lng},title:o.name(),animation:google.maps.Animation.DROP,map:map}),o.mapMarker.addListener("click",function(){activateMarker(map,o.mapMarker,o)})},map,initMap=function(){const e={lat:46.724258,lng:6.532064};map=new google.maps.Map(document.getElementById("map-canvas"),{center:e,zoom:13})},infowindow,ViewModel=function(){var e=this;e.locationList=ko.observableArray([]),e.searchName=ko.observable(""),localOrbe.forEach(function(o){e.locationList.push(new Poi(o))});var o={OAUTH_TOKEN:"LOJ2DURA4KDE3HIOZH1TP0NAEP1XGIFLQP0FVAE2LHYFFKLR",baseURL:"https://api.foursquare.com/v2/venues/"};e.locationList().forEach(function(e){$.ajax({url:o.baseURL+e.fourID(),dataType:"json",data:"oauth_token="+o.OAUTH_TOKEN+"&v=20160613",success:function(o){e.fourWeb(o.response.venue.shortUrl)},error:function(e){alert("Requested FourSquare data failed to load: \n"+e.statusText)}})});var t=o.baseURL+"explore?ll=46.724258,6.532064&radius=5000&limit=5&venuePhotos=1&section=coffee&mode=url&oauth_token="+o.OAUTH_TOKEN+"&v=20160615";$.getJSON(t).done(function(o){for(var t=o.response.groups[0].items,a=[],n=0;n<t.length;n++){var i={name:t[n].venue.name,location:{lat:t[n].venue.location.lat,lng:t[n].venue.location.lng},category:t[n].venue.categories[0].shortName,fourID:t[n].venue.id,fourWeb:"https://foursquare.com/v/"+t[n].venue.id};t[n].venue.hasOwnProperty("featuredPhotos")?i.imgSrc=t[n].venue.featuredPhotos.items[0].prefix+"200x150"+t[n].venue.featuredPhotos.items[0].suffix:i.imgSrc="http://placehold.it/200x150?text="+t[n].venue.categories[0].shortName,t[n].hasOwnProperty("tips")?i.snippet=t[n].tips[0].text:i.snippet="No reviews yet...",a.push(i)}a.forEach(function(o){e.locationList.push(new Poi(o))})}).fail(function(e,o,t){var a=o+", "+t;alert("Requested FourSquare data failed to load: \n"+a)}),e.currentPoi=ko.observable(this.locationList()[0].name()),console.log(e.currentPoi()),e.searchResults=ko.computed(function(){var o=[],t=e.searchName().toLowerCase();return ko.utils.arrayFilter(e.locationList(),function(e){return e.name().toLowerCase().indexOf(t)>=0?(o.push(e),resetMarkers(),e.mapMarker.setVisible(!0),o):void e.mapMarker.setVisible(!1)})}),e.setCurrentPoi=function(o){activateMarker(map,o.mapMarker,o),e.currentPoi(o.name())}},googleLoadError=function(){alert("Google maps load error")};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJzZXRJbmZvV2luZG93IiwibWFwIiwibWFya2VyIiwicG9pIiwiY29udGVudFN0cmluZyIsImltYWdlU3JjIiwibmFtZSIsInNuaXBwZXQiLCJmb3VyV2ViIiwidW5kZWZpbmVkIiwiaW5mb3dpbmRvdyIsImNsb3NlIiwiZ29vZ2xlIiwibWFwcyIsIkluZm9XaW5kb3ciLCJjb250ZW50IiwibWF4V2lkdGgiLCJvcGVuIiwiYWRkQm91bmNlVGltZW91dCIsImdldEFuaW1hdGlvbiIsInNldEFuaW1hdGlvbiIsIkFuaW1hdGlvbiIsIkJPVU5DRSIsInNldFRpbWVvdXQiLCJhY3RpdmF0ZU1hcmtlciIsInBhblRvIiwibGF0IiwibG9jYXRpb24iLCJsbmciLCJyZXNldE1hcmtlcnMiLCJnZXRCb3QiLCJ0aXRsZSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJ0ZXh0Q29udGVudCIsIiQiLCJhamF4IiwidXJsIiwidHlwZSIsImRhdGEiLCJkYXRhVHlwZSIsInN1Y2Nlc3MiLCJxdWVyeVNlbGVjdG9yIiwic3JjIiwiaW1hZ2VVcmwiLCJpbm5lckhUTUwiLCJlcnJvciIsImVyciIsImFsZXJ0Iiwic3RhdHVzVGV4dCIsImJlZm9yZVNlbmQiLCJ4aHIiLCJzZXRSZXF1ZXN0SGVhZGVyIiwiZ2V0T3JpZyIsImNvbnNvbGUiLCJsb2ciLCJnb29nbGVTdWNjZXNzIiwiaW5pdE1hcCIsImtvIiwiYXBwbHlCaW5kaW5ncyIsIlZpZXdNb2RlbCIsImdvb2dsZUxvYWRFcnJvciIsImxvY2FsT3JiZSIsImNhdGVnb3J5IiwiZm91cklEIiwiaW1nU3JjIiwiUG9pIiwianNvbiIsInNlbGYiLCJ0aGlzIiwib2JzZXJ2YWJsZSIsIm1hcE1hcmtlciIsIk1hcmtlciIsInBvc2l0aW9uIiwiYW5pbWF0aW9uIiwiRFJPUCIsImFkZExpc3RlbmVyIiwiT1JCRSIsIk1hcCIsImNlbnRlciIsInpvb20iLCJsb2NhdGlvbkxpc3QiLCJvYnNlcnZhYmxlQXJyYXkiLCJzZWFyY2hOYW1lIiwiZm9yRWFjaCIsInB1c2giLCJmb3VySW5mbyIsIk9BVVRIX1RPS0VOIiwiYmFzZVVSTCIsInJlc3BvbnNlIiwidmVudWUiLCJzaG9ydFVybCIsImV4cGxvcmVVUkwiLCJnZXRKU09OIiwiZG9uZSIsImdvdEpTT04iLCJncm91cHMiLCJpdGVtcyIsInJlc3VsdHMiLCJpIiwibGVuZ3RoIiwiaXRlbSIsImNhdGVnb3JpZXMiLCJzaG9ydE5hbWUiLCJpZCIsImhhc093blByb3BlcnR5IiwiZmVhdHVyZWRQaG90b3MiLCJwcmVmaXgiLCJzdWZmaXgiLCJ0aXBzIiwidGV4dCIsImZhaWwiLCJqcXhociIsInRleHRTdGF0dXMiLCJjdXJyZW50UG9pIiwic2VhcmNoUmVzdWx0cyIsImNvbXB1dGVkIiwic2VhcmNoIiwidG9Mb3dlckNhc2UiLCJ1dGlscyIsImFycmF5RmlsdGVyIiwiaW5kZXhPZiIsInNldFZpc2libGUiLCJzZXRDdXJyZW50UG9pIl0sIm1hcHBpbmdzIjoiQUE0RkEsUUFBQUEsZUFBQUMsRUFBQUMsRUFBQUMsR0FDQSxHQUNBQyxJQURBRCxFQUFBRSxXQUNBLHdFQUNBRixFQUFBRSxXQUFBLCtLQUlBRixFQUFBRyxPQUFBLG9DQUVBSCxFQUFBRyxPQUFBLFNBQUFILEVBQUFJLFVBQUEsNEJBQ0FKLEVBQUFLLFVBQUEsbURBSUFDLFVBQUFDLFlBQUFBLFdBQUFDLFFBQ0FELFdBQUEsR0FBQUUsUUFBQUMsS0FBQUMsWUFDQUMsUUFBQVgsRUFDQVksU0FBQSxNQUVBTixXQUFBTyxLQUFBaEIsRUFBQUMsRUFBQUMsR0FHQSxRQUFBZSxrQkFBQWhCLEdBQ0EsT0FBQUEsRUFBQWlCLGVBQ0FqQixFQUFBa0IsYUFBQSxPQUVBbEIsRUFBQWtCLGFBQUFSLE9BQUFDLEtBQUFRLFVBQUFDLFFBQ0FDLFdBQUEsV0FDQXJCLEVBQUFrQixhQUFBLE9BQ0EsT0FJQSxRQUFBSSxnQkFBQXZCLEVBQUFDLEVBQUFDLEdBQ0FGLEVBQUF3QixPQUNBQyxJQUFBdkIsRUFBQXdC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QUksR0FBQVUsS0FBQSxHQUFBQyxLQUVBVCxFQUFBOUYsUUFBQSxvQkFFQTJGLEVBQUFiLEtBQUFnQixHQUVBSCxFQUFBZCxRQUFBLFNBQUFqQixHQUNBQyxFQUFBYSxhQUFBSSxLQUFBLEdBQUFuQixLQUFBQyxRQUdBNEMsS0FBQSxTQUFBQyxFQUFBQyxFQUFBbkUsR0FDQSxHQUFBQyxHQUFBa0UsRUFBQSxLQUFBbkUsQ0FDQUUsT0FBQSwrQ0FBQUQsS0FHQXFCLEVBQUE4QyxXQUFBeEQsR0FBQVksV0FBQUQsS0FBQVksZUFBQSxHQUFBM0UsUUFDQWdELFFBQUFDLElBQUFhLEVBQUE4QyxjQUdBOUMsRUFBQStDLGNBQUF6RCxHQUFBMEQsU0FBQSxXQUNBLEdBQUFsQixNQUNBbUIsRUFBQWpELEVBQUFlLGFBQUFtQyxhQUNBLE9BQUE1RCxJQUFBNkQsTUFBQUMsWUFBQXBELEVBQUFhLGVBQUEsU0FBQTlFLEdBQ0EsTUFBQUEsR0FBQUcsT0FBQWdILGNBQUFHLFFBQUFKLElBQUEsR0FDQW5CLEVBQUFiLEtBQUFsRixHQUNBMEIsZUFDQTFCLEVBQUFvRSxVQUFBbUQsWUFBQSxHQUNBeEIsT0FFQS9GLEdBQUFvRSxVQUFBbUQsWUFBQSxPQUtBdEQsRUFBQXVELGNBQUEsU0FBQXhILEdBQ0FxQixlQUFBdkIsSUFBQUUsRUFBQW9FLFVBQUFwRSxHQUNBaUUsRUFBQThDLFdBQUEvRyxFQUFBRyxVQWFBdUQsZ0JBQUEsV0FDQWIsTUFBQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogPT09PT09PSBNb2RlbCA9PT09PT09ICovXG4vLyBqc29uIGRhdGEgZm9yIHBsYWNlcyBpbiBPcmJlXG4vKiA9PT09PT09ID09PT09ID09PT09PT0gKi9cbnZhciBsb2NhbE9yYmUgPSBbe1xuICBcIm5hbWVcIjogXCJMYSBUb3VyIFJvbmRlXCIsXG4gIFwibG9jYXRpb25cIjoge1xuICAgIFwibGF0XCI6IDQ2LjcyNTIyOCxcbiAgICBcImxuZ1wiOiA2LjUzMjY1MVxuICB9LFxuICBcImNhdGVnb3J5XCI6IFwiSGlzdG9yaWMgU2l0ZVwiLFxuICBcImZvdXJJRFwiOiBcIjU3NDlkMGQ3NDk4ZWVhYWRjNTNkMWE5NFwiLFxuICBcImltZ1NyY1wiOiBcImh0dHBzOi8vc3RhdGljLnBhbm9yYW1pby5jb20uc3RvcmFnZS5nb29nbGVhcGlzLmNvbS9waG90b3Mvc21hbGwvNTU2NjgwMDkuanBnXCIsXG4gIFwic25pcHBldFwiOiBcIlRoZSBSb3VuZCBUb3dlciBpcyBwYXJ0IG9mIHRoZSB0b3duJ3MgYW5jaWVudCBjYXN0bGUuIEl0IG9mZmVycyBzcGxlbmRpZCAzNjDCsCBwYW5vcmFtaWMgdmlld3Mgb3ZlciB0aGUgdG93biwgdGhlIEp1cmEgbW91bnRhaW4gcmFuZ2UsIGFuZCB0aGUgQWxwcy5cIlxufSwge1xuICBcIm5hbWVcIjogXCJRdWFydGllciBkZXMgVmlldXggTW91bGluc1wiLFxuICBcImxvY2F0aW9uXCI6IHtcbiAgICBcImxhdFwiOiA0Ni43MjA5MjYsXG4gICAgXCJsbmdcIjogNi41MzI0NjdcbiAgfSxcbiAgXCJjYXRlZ29yeVwiOiBcIlNjZW5pYyBMb29rb3V0XCIsXG4gIFwiZm91cklEXCI6IFwiNTc1ZWU0ZmU0OThlMzJiZmZlM2IyMDFmXCIsXG4gIFwiaW1nU3JjXCI6IFwiaHR0cHM6Ly9zdGF0aWMucGFub3JhbWlvLmNvbS5zdG9yYWdlLmdvb2dsZWFwaXMuY29tL3Bob3Rvcy9zbWFsbC83NDkyMDQ1NS5qcGdcIixcbiAgXCJzbmlwcGV0XCI6IFwiVGhlIGFuY2llbnQgZmxvdXJtaWxscyBkYXRlIGJhY2sgdG8gMTQyMyBhbmQgd2VyZSBpbiB1c2UgdW50aWwgdGhlIHZlcnkgZW5kIG9mIHRoZSAxOTkwcy5cIlxufSwge1xuICBcIm5hbWVcIjogXCJMZXMgR29yZ2VzIGRlIGwnT3JiZVwiLFxuICBcImxvY2F0aW9uXCI6IHtcbiAgICBcImxhdFwiOiA0Ni43Mjc1MzYsXG4gICAgXCJsbmdcIjogNi41MDkxMTBcbiAgfSxcbiAgXCJjYXRlZ29yeVwiOiBcIlRyYWlsXCIsXG4gIFwiZm91cklEXCI6IFwiNGRmZGQ3MWVjNjViMzE1NzliMzMwZjQwXCIsXG4gIFwiaW1nU3JjXCI6IFwiaHR0cHM6Ly9zdGF0aWMucGFub3JhbWlvLmNvbS5zdG9yYWdlLmdvb2dsZWFwaXMuY29tL3Bob3Rvcy9zbWFsbC81NTY2Nzc0NS5qcGdcIixcbiAgXCJzbmlwcGV0XCI6IFwiQSB3YWxrIHRocm91Z2ggdGhlIGdvcmdlcyBvZiB0aGUgUml2ZXIgT3JiZSBwcmVzZW50cyBoaWtlcnMgd2l0aCBhIHdlYWx0aCBvZiBuYXR1cmFsIHJlc291cmNlcyBpbiB0aGUgZm9vdGhpbGxzIG9mIHRoZSBKdXJhIE1vdW50YWlucywgYmV0d2VlbiBWYWxsb3JiZSBhbmQgT3JiZS5cIlxufSwge1xuICBcIm5hbWVcIjogXCJNdXIgZCdlc2NhbGFkZSwgQ2hhdm9ybmF5XCIsXG4gIFwibG9jYXRpb25cIjoge1xuICAgIFwibGF0XCI6IDQ2LjcwNzY5LFxuICAgIFwibG5nXCI6IDYuNTY2ODcxXG4gIH0sXG4gIFwiY2F0ZWdvcnlcIjogXCJDbGltYmluZyBHeW1cIixcbiAgXCJmb3VySURcIjogXCI0Yzc0NTk2ZTFiMzBhMDkzYzM4MGVjMDlcIixcbiAgXCJpbWdTcmNcIjogXCJodHRwczovL2lyczAuNHNxaS5uZXQvaW1nL2dlbmVyYWwvd2lkdGg5NjAvMzE1MjM5X3ZGQ3Q2XzB5eVFKdEgycTdMcUg5M0ZLWU1JOHlaVWZOdnJwU3QxalZ2RFkuanBnXCIsXG4gIFwic25pcHBldFwiOiBcIlRoZSBjbGltYmluZyB3YWxsIGF0IENoYXZvcm5heSBpcyBkaXZpZGVkIGludG8gZml2ZSBzZXBhcmF0ZSB6b25lcywgaW5jbHVkaW5nIGJvdWxkZXJpbmcsIGNoaWxkcmVuJ3MgYXJlYSBhbmQgbGVhZCB3YWxscy5cIlxufSwge1xuICBcIm5hbWVcIjogXCJPcmJlIMOgIHBldGl0cyBwYXNcIixcbiAgXCJsb2NhdGlvblwiOiB7XG4gICAgXCJsYXRcIjogNDYuNzIzMTY4LFxuICAgIFwibG5nXCI6IDYuNTI5NTcwXG4gIH0sXG4gIFwiY2F0ZWdvcnlcIjogXCJUcmFpbFwiLFxuICBcImZvdXJJRFwiOiBcIjRmNzg2YTUyZTRiMDU1Yzc2MThjMTU3ZVwiLFxuICBcImltZ1NyY1wiOiBcImh0dHBzOi8vc3RhdGljLnBhbm9yYW1pby5jb20uc3RvcmFnZS5nb29nbGVhcGlzLmNvbS9waG90b3Mvc21hbGwvMjA0Njg2OTIuanBnXCIsXG4gIFwic25pcHBldFwiOiBcIlR3byBlYXN5IHdhbGtzLCBtYXJrZWQgd2l0aCB5ZWxsb3cgYW5kIHJlZCBzdGVwcyBvbiB0aGUgZ3JvdW5kLCBndWlkZSB5b3UgYXJvdW5kIHRoZSB0b3duLCBpdHMgc3Vycm91bmRpbmdzLCBhbmQgdGhlIHJpdmVyLlwiXG59XTtcblxuLyogPT09PT09PSBsaXN0IFZpZXcgPT09PT09PSAqL1xuLy8gUG9pKCkgUG9pbnQgb2YgSW50ZXJlc3Rcbi8vIG9ic2VydmFibGVzOlxuLy8gUG9pLm5hbWVcbi8vIFBvaS5sb2NhdGlvblxuLy8gUG9pLmNhdGVnb3J5XG4vLyBQb2kuaW1hZ2VTcmNcbi8vIFBvaS5mb3VySURcbi8vIFBvaS5mb3VyV2ViXG4vLyBQb2kuc25pcHBldFxuLyogPT09PT09PSA9PT09PT09PT0gPT09PT09PSAqL1xuXG4vLyBqc29uIGlzIGFuIG9iamVjdCBsaXRlcmFsIHRoYXQgY29udGFpbnMgbG9jYXRpb24gZGF0YSBmb3IgYSBzaW5nbGUgcG9pIGluIE9yYmVcbi8vIFBvaSBpcyBhbiBvYmplY3QgY29uc3R1Y3RvciBmb3IgYSBzaW5nbGUgcGxhY2Ugb2YgaW50ZXJlc3RcbnZhciBQb2kgPSBmdW5jdGlvbihqc29uKSB7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgc2VsZi5uYW1lID0ga28ub2JzZXJ2YWJsZShqc29uLm5hbWUpO1xuICBzZWxmLmxvY2F0aW9uID0ga28ub2JzZXJ2YWJsZShqc29uLmxvY2F0aW9uKTtcbiAgc2VsZi5jYXRlZ29yeSA9IGtvLm9ic2VydmFibGUoanNvbi5jYXRlZ29yeSk7XG4gIHNlbGYuZm91cklEID0ga28ub2JzZXJ2YWJsZShqc29uLmZvdXJJRCk7XG4gIHNlbGYuaW1hZ2VTcmMgPSBrby5vYnNlcnZhYmxlKGpzb24uaW1nU3JjKTtcbiAgc2VsZi5zbmlwcGV0ID0ga28ub2JzZXJ2YWJsZShqc29uLnNuaXBwZXQpO1xuICBzZWxmLmZvdXJXZWIgPSBrby5vYnNlcnZhYmxlKGpzb24uZm91cldlYik7XG4gIC8vIGF0dGFjaCB0aGUgbWFwIG1hcmtlciBmb3IgdGhpcyBQb2kgb2JqZWN0XG4gIHNlbGYubWFwTWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XG4gICAgcG9zaXRpb246IHtcbiAgICAgIGxhdDogc2VsZi5sb2NhdGlvbigpLmxhdCxcbiAgICAgIGxuZzogc2VsZi5sb2NhdGlvbigpLmxuZ1xuICAgIH0sXG4gICAgdGl0bGU6IHNlbGYubmFtZSgpLFxuICAgIGFuaW1hdGlvbjogZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkRST1AsXG4gICAgbWFwOiBtYXBcbiAgfSk7XG4gIC8vICBhZGQgY2xpY2sgaGFuZGxlciB0byBtYXJrZXJcbiAgc2VsZi5tYXBNYXJrZXIuYWRkTGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgYWN0aXZhdGVNYXJrZXIobWFwLCBzZWxmLm1hcE1hcmtlciwgc2VsZik7XG4gIH0pO1xufTtcblxuXG4vKiA9PT09PT09IEdvb2dsZSBNYXBzID09PT09PT0gKi9cbi8vIG1hcCwgaW5mb3dpbmRvd1xuLy8gaW5pdE1hcCgpXG4vLyBzZXRJbmZvV2luZG93KG1hcCwgbWFya2VyLCBwb2kpXG4vLyBhZGRCb3VuY2VUaW1lb3V0KG1hcmtlcilcbi8vIGFjdGl2YXRlTWFya2VyKG1hcCwgbWFya2VyLCBwb2kpXG4vLyByZXNldE1hcmtlcnMoKVxuLy8gZ2V0Qm90KClcbi8vIGdldE9yaWcoaW1hZ2VTcmMpXG4vKiA9PT09PT09ID09PT09PT09PT09ID09PT09PT0gKi9cblxuLy8gc2ltcGxlIG1hcCBleGFtcGxlIGZyb20gZ29vZ2xlIGFwaVxudmFyIG1hcDtcbnZhciBpbml0TWFwID0gZnVuY3Rpb24oKSB7XG4gIGNvbnN0IE9SQkUgPSB7XG4gICAgbGF0OiA0Ni43MjQyNTgsXG4gICAgbG5nOiA2LjUzMjA2NFxuICB9O1xuICBtYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAtY2FudmFzJyksIHtcbiAgICBjZW50ZXI6IE9SQkUsXG4gICAgem9vbTogMTNcbiAgfSk7XG59O1xuXG4vLyBhZGQgc2ltcGxlIGluZm8gd2luZG93IHRvIHBvaSBtYXJrZXJcbi8vIG9ubHkgd2FudCBvbmUgaW5mbyB3aW5kb3cgb3BlbiBhdCBhIHRpbWUuIHVzZSBnbG9iYWwgdG8ga2VlcCB0cmFjayBvZiBleGlzdGluZyB3aW5kb3dcbnZhciBpbmZvd2luZG93O1xuXG5mdW5jdGlvbiBzZXRJbmZvV2luZG93KG1hcCwgbWFya2VyLCBwb2kpIHtcbiAgdmFyIG9yaWcgPSBwb2kuaW1hZ2VTcmMoKTtcbiAgdmFyIGNvbnRlbnRTdHJpbmcgPSAnPGRpdiBpZD1cImNvbnRlbnRcIj4nICtcbiAgICAnPGRpdj48aW1nIGlkPVwib3Jib3RcIiB3aWR0aD1cIjIwMFwiIGhlaWdodD1cIjE1MFwiIHNyYz1cIicgKyBwb2kuaW1hZ2VTcmMoKSArICdcIj48L2Rpdj4nICtcbiAgICAnPGRpdiBjbGFzcz1cIm9yYm90XCI+PGJ1dHRvbiBjbGFzcz1cImJ0bi1kYW5nZXJcIiBvbmNsaWNrPVwiZ2V0Qm90KClcIj5PcmJvdC4uLiAzIDIgMTwvYnV0dG9uPicgK1xuICAgICc8cCBpZD1cImF0dHJpYnV0ZVJvYm90XCI+PC9wPicgK1xuICAgIC8vJzxidXR0b24gY2xhc3M9XCJidG4tc3VjY2Vzc1wiIG9uY2xpY2s9XCJnZXRPcmlnKCcrIG9yaWcgKycpXCI+V2hvYS4uLiBVbmRvISE8L2J1dHRvbj4nICtcbiAgICAnPC9kaXY+JyArXG4gICAgJzxoNCBpZD1cImZpcnN0SGVhZGluZ1wiIGNsYXNzPVwiZmlyc3RIZWFkaW5nXCI+JyArIHBvaS5uYW1lKCkgKyAnPC9oND4nICtcbiAgICAnPGRpdiBpZD1cImJvZHlDb250ZW50XCI+JyArXG4gICAgJzxwPjxiPicgKyBwb2kubmFtZSgpICsgJzwvYj4uICcgKyBwb2kuc25pcHBldCgpICsgJzwvcD4nICtcbiAgICAnPHA+IFZpZXcgb24gPGEgaHJlZj1cIicgKyBwb2kuZm91cldlYigpICsgJ1wiIHRhcmdldD1cIl9ibGFua1wiPkZvdXJTcXVhcmU8L2E+PC9wPicgK1xuICAgICc8L2Rpdj4nICtcbiAgICAnPC9kaXY+JztcblxuICAvLyBpZiBhbiBvcGVuIHdpbmRvdyBleGlzdHMsIGNsb3NlIGl0IGJlZm9yZSBtYWtpbmcgbmV3IG9uZVxuICBpZiAoaW5mb3dpbmRvdyAhPT0gdW5kZWZpbmVkKSBpbmZvd2luZG93LmNsb3NlKCk7XG4gIGluZm93aW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdyh7XG4gICAgY29udGVudDogY29udGVudFN0cmluZyxcbiAgICBtYXhXaWR0aDogMjIwXG4gIH0pO1xuICBpbmZvd2luZG93Lm9wZW4obWFwLCBtYXJrZXIsIHBvaSk7XG59XG5cbmZ1bmN0aW9uIGFkZEJvdW5jZVRpbWVvdXQobWFya2VyKSB7XG4gIGlmIChtYXJrZXIuZ2V0QW5pbWF0aW9uKCkgIT09IG51bGwpIHtcbiAgICBtYXJrZXIuc2V0QW5pbWF0aW9uKG51bGwpO1xuICB9IGVsc2Uge1xuICAgIG1hcmtlci5zZXRBbmltYXRpb24oZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkJPVU5DRSk7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgIG1hcmtlci5zZXRBbmltYXRpb24obnVsbCk7XG4gICAgfSwgMjEwMCk7XG4gIH1cbn1cblxuLy8gZ29vZ2xlIG1hcHMgcGFuVG8gbWV0aG9kIHVzZWQgdG8gY2hhbmdlIHRoZSBjZW50ZXIgb2YgdGhlIG1hcCB0byB0aGUgZ2l2ZW4gTGF0TG5nXG5mdW5jdGlvbiBhY3RpdmF0ZU1hcmtlcihtYXAsIG1hcmtlciwgcG9pKSB7XG4gIG1hcC5wYW5Ubyh7XG4gICAgbGF0OiBwb2kubG9jYXRpb24oKS5sYXQsXG4gICAgbG5nOiBwb2kubG9jYXRpb24oKS5sbmdcbiAgfSk7XG4gIGFkZEJvdW5jZVRpbWVvdXQobWFya2VyKTtcbiAgc2V0SW5mb1dpbmRvdyhtYXAsIG1hcmtlciwgcG9pKTtcbn1cblxuZnVuY3Rpb24gcmVzZXRNYXJrZXJzKCkge1xuICAvLyBpZiBhbiBvcGVuIHdpbmRvdyBleGlzdHMsIGNsb3NlIGl0XG4gIGlmIChpbmZvd2luZG93ICE9PSB1bmRlZmluZWQpIGluZm93aW5kb3cuY2xvc2UoKTtcbn1cblxuZnVuY3Rpb24gZ2V0Qm90KCkge1xuICB2YXIgdGl0bGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZpcnN0SGVhZGluZ1wiKS50ZXh0Q29udGVudDtcbiAgdmFyIG91dHB1dCA9ICQuYWpheCh7XG4gICAgdXJsOiAnaHR0cHM6Ly9yb2JvaGFzaC5wLm1hc2hhcGUuY29tL2luZGV4LnBocD8nLCAvLyBUaGUgVVJMIHRvIHRoZSBBUEkuIFlvdSBjYW4gZ2V0IHRoaXMgYnkgY2xpY2tpbmcgb24gXCJTaG93IENVUkwgZXhhbXBsZVwiIGZyb20gYW4gQVBJIHByb2ZpbGVcbiAgICB0eXBlOiAnR0VUJywgLy8gVGhlIEhUVFAgTWV0aG9kLCBjYW4gYmUgR0VUIFBPU1QgUFVUIERFTEVURSBldGNcbiAgICBkYXRhOiAndGV4dD0nICsgdGl0bGUsIC8vIEFkZGl0aW9uYWwgcGFyYW1ldGVycyBoZXJlXG4gICAgZGF0YVR5cGU6ICdqc29uJyxcbiAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI29yYm90XCIpLnNyYyA9IGRhdGEuaW1hZ2VVcmw7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F0dHJpYnV0ZVJvYm90XCIpLmlubmVySFRNTCA9IFwiRnJpZW5kbHkgcm9ib3QgYnkgUm9ib2hhc2gub3JnXCI7XG4gICAgfSxcbiAgICBlcnJvcjogZnVuY3Rpb24oZXJyKSB7XG4gICAgICBhbGVydChcIkRvZXMgbm90IGNvbXB1dGUsIG5vIHJvYm90IHJhbXBhZ2VzIGF0IHRoaXMgdGltZTogXFxuXCIgKyBlcnIuc3RhdHVzVGV4dCk7XG4gICAgfSxcbiAgICBiZWZvcmVTZW5kOiBmdW5jdGlvbih4aHIpIHtcbiAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKFwiWC1NYXNoYXBlLUF1dGhvcml6YXRpb25cIiwgXCJWZ01HRk5tcHo3bXNoQU5PSnUxdnlvalh4dFBTcDFFSmxxaGpzbmR5MWU2OVY4ZnJvVlwiKTsgLy8gRW50ZXIgaGVyZSB5b3VyIE1hc2hhcGUga2V5XG4gICAgfVxuICB9KTtcbn1cblxuLy8gSSBjYW5ub3QgZ2V0IGEgcmVzZXQgYnV0dG9uIHRvIHdvcmshXG4vLyB1bmNvbW1lbnQgbGluZSBiZWcgPGJ1dHRvbiBjbGFzcz1cImJ0bi1zdWNjZXNzXCIgaW4gc2V0SW5mb1dpbmRvd1xuLy8gZ2V0IHRoaXMgZXJyb3IgbWVzc2FnZTpcbi8vIFVuY2F1Z2h0IFN5bnRheEVycm9yOiBtaXNzaW5nICkgYWZ0ZXIgYXJndW1lbnQgbGlzdFxuLy8gPz8/IHNlZW1zIHRvIHJlZmVyIHRvIGluZGV4Lmh0bWwgPCFET0NUWVBFIGh0bWw+XG5mdW5jdGlvbiBnZXRPcmlnKGltYWdlU3JjKSB7XG4gIGNvbnNvbGUubG9nKGltYWdlU3JjKTtcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNvcmJvdFwiKS5zcmMgPSBpbWFnZVNyYztcbn1cblxuLyogPT09PT09PSBWaWV3TW9kZWwgPT09PT09PSAqL1xuLy8gVmlld01vZGVsKClcbi8qID09PT09PT0gPT09PT09PT09PT0gPT09PT09PSAqL1xuXG52YXIgVmlld01vZGVsID0gZnVuY3Rpb24oKSB7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgLy8gY3JlYXRlIGFycmF5IG9mIHBsYWNlc1xuICBzZWxmLmxvY2F0aW9uTGlzdCA9IGtvLm9ic2VydmFibGVBcnJheShbXSk7XG4gIHNlbGYuc2VhcmNoTmFtZSA9IGtvLm9ic2VydmFibGUoJycpO1xuXG4gIC8vIHBhc3MgbG9jYWxPcmJlIG9iamVjdCBsaXRlcmFsIGpzb24gZGF0YSB0byBuZXcgUG9pXG4gIC8vIGxvb3Agb3ZlciB0aGUganNvbiBhcnJheSBhbmQgcHVzaCBlYWNoIG5ldyBwb2kgaW50byBsb2NhdGlvbkxpc3RcbiAgLy8gdXNlICdzZWxmJyB0byBhdm9pZCAndGhpcycga2V5d29yZCBzY29wZSBjb25mdXNpb25cbiAgbG9jYWxPcmJlLmZvckVhY2goZnVuY3Rpb24oanNvbikge1xuICAgIHNlbGYubG9jYXRpb25MaXN0LnB1c2gobmV3IFBvaShqc29uKSk7XG4gIH0pO1xuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvLyBGb3VyU3F1YXJlIEFQSVxuICAvLyBodHRwczovL2FwaS5mb3Vyc3F1YXJlLmNvbS92Mi92ZW51ZXMvZXhwbG9yZVxuICAvLyBodHRwczovL2FwaS5mb3Vyc3F1YXJlLmNvbS92Mi92ZW51ZXMvVkVOVUVfSURcbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gYWRkIGRldGFpbCB0byBoYXJkY29kZWRcbiAgLy8gRm9yIGVhY2ggcG9pIGluIGxvY2F0aW9uTGlzdCwgcmVxdWVzdCBGb3Vyc3F1YXJlIGRhdGEgZm9yIHRoZSBpbmZvd2luZG93XG4gIHZhciBmb3VySW5mbyA9IHtcbiAgICBPQVVUSF9UT0tFTjogJ0xPSjJEVVJBNEtERTNISU9aSDFUUDBOQUVQMVhHSUZMUVAwRlZBRTJMSFlGRktMUicsXG4gICAgYmFzZVVSTDogJ2h0dHBzOi8vYXBpLmZvdXJzcXVhcmUuY29tL3YyL3ZlbnVlcy8nXG4gIH07XG5cbiAgLy8gbWFrZSBBamF4IHJlcXVlc3Qgb24gVkVOVUVfSUQgdG8gYWRkIGxpbmsgc3VwcGxpZWQgYnkgZm91cnNxdWFyZSB0byBlYWNoIGV4aXN0aW5nIHBvaVxuICBzZWxmLmxvY2F0aW9uTGlzdCgpLmZvckVhY2goZnVuY3Rpb24ocG9pKSB7XG4gICAgJC5hamF4KHtcbiAgICAgIHVybDogZm91ckluZm8uYmFzZVVSTCArIHBvaS5mb3VySUQoKSxcbiAgICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgICBkYXRhOiAnb2F1dGhfdG9rZW49JyArIGZvdXJJbmZvLk9BVVRIX1RPS0VOICtcbiAgICAgICAgJyZ2PTIwMTYwNjEzJyxcbiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgcG9pLmZvdXJXZWIoZGF0YS5yZXNwb25zZS52ZW51ZS5zaG9ydFVybCk7XG4gICAgICB9LFxuICAgICAgZXJyb3I6IGZ1bmN0aW9uKGVycikge1xuICAgICAgICBhbGVydChcIlJlcXVlc3RlZCBGb3VyU3F1YXJlIGRhdGEgZmFpbGVkIHRvIGxvYWQ6IFxcblwiICsgZXJyLnN0YXR1c1RleHQpO1xuICAgICAgfSxcbiAgICB9KTtcbiAgfSk7XG5cbiAgLy8gZXhhbXBsZSBvZiBjYWxsIHRvIGV4cGxvcmVcbiAgLy8gaHR0cHM6Ly9hcGkuZm91cnNxdWFyZS5jb20vdjIvdmVudWVzL2V4cGxvcmU/bGw9NDAuNywtNzQmb2F1dGhfdG9rZW49TE9KMkRVUkE0S0RFM0hJT1pIMVRQME5BRVAxWEdJRkxRUDBGVkFFMkxIWUZGS0xSJnY9MjAxNjA2MTVcbiAgLy8gYmFzZWQgb24ganNvbiBvdXRwdXQgd2FudCB0byBuYXJyb3cgaW4gb246IGRhdGEucmVzcG9uc2UuZ3JvdXBzWzBdLml0ZW1zXG4gIC8vIHRoZW4gZHJpbGwgZG93biB0bzpcbiAgLy8gdmVudWUuaWQgdmVudWUubmFtZVxuICAvLyB2ZW51ZS5sb2NhdGlvbi5sYXQgdmVudWUubG9jYXRpb24ubG5nXG4gIC8vIHZlbnVlLmZlYXR1cmVkUGhvdG9zLml0ZW1zWzBdLnByZWZpeCAuc3VmZml4ICAuaWQgLy8gY2FuIG5vdCBiZSByZWxpZWQgdXBvbiBhcyBmZWF0dXJlZFBob3RvcyBteSBub3QgZXhpc3RcbiAgLy8gdGlwc1swXS5jYW5vbmljYWxVcmwgdGlwc1swXS50ZXh0IC8vIGNhbiBub3QgYmUgcmVsaWVkIHVwb24gYXMgdGlwcyBteSBub3QgZXhpc3RcblxuICAvLyBTdGVwIDE6IEdldCB0aGUgcmVzdWx0c1xuICB2YXIgZXhwbG9yZVVSTCA9IGZvdXJJbmZvLmJhc2VVUkwgK1xuICAgICdleHBsb3JlP2xsPTQ2LjcyNDI1OCw2LjUzMjA2NCZyYWRpdXM9NTAwMCZsaW1pdD01JnZlbnVlUGhvdG9zPTEnICtcbiAgICAnJnNlY3Rpb249Y29mZmVlJyArXG4gICAgJyZtb2RlPXVybCcgK1xuICAgICcmb2F1dGhfdG9rZW49JyArIGZvdXJJbmZvLk9BVVRIX1RPS0VOICtcbiAgICAnJnY9MjAxNjA2MTUnO1xuXG4gICQuZ2V0SlNPTihleHBsb3JlVVJMKVxuICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgIHZhciBnb3RKU09OID0gZGF0YS5yZXNwb25zZS5ncm91cHNbMF0uaXRlbXM7XG4gICAgICAvLyBTdGVwIDI6IFByb2Nlc3MgdGhlIHJlc3VsdHMgaW50byB0aGUgZm9ybSB5b3Ugd2FudFxuICAgICAgdmFyIHJlc3VsdHMgPSBbXTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZ290SlNPTi5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgaXRlbSA9IHtcbiAgICAgICAgICBcIm5hbWVcIjogZ290SlNPTltpXS52ZW51ZS5uYW1lLFxuICAgICAgICAgIFwibG9jYXRpb25cIjoge1xuICAgICAgICAgICAgXCJsYXRcIjogZ290SlNPTltpXS52ZW51ZS5sb2NhdGlvbi5sYXQsXG4gICAgICAgICAgICBcImxuZ1wiOiBnb3RKU09OW2ldLnZlbnVlLmxvY2F0aW9uLmxuZ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJjYXRlZ29yeVwiOiBnb3RKU09OW2ldLnZlbnVlLmNhdGVnb3JpZXNbMF0uc2hvcnROYW1lLFxuICAgICAgICAgIFwiZm91cklEXCI6IGdvdEpTT05baV0udmVudWUuaWQsXG4gICAgICAgICAgXCJmb3VyV2ViXCI6IFwiaHR0cHM6Ly9mb3Vyc3F1YXJlLmNvbS92L1wiICsgZ290SlNPTltpXS52ZW51ZS5pZFxuICAgICAgICB9O1xuICAgICAgICBpZiAoZ290SlNPTltpXS52ZW51ZS5oYXNPd25Qcm9wZXJ0eSgnZmVhdHVyZWRQaG90b3MnKSkge1xuICAgICAgICAgIGl0ZW0uaW1nU3JjID0gZ290SlNPTltpXS52ZW51ZS5mZWF0dXJlZFBob3Rvcy5pdGVtc1swXS5wcmVmaXggKyAnMjAweDE1MCcgKyBnb3RKU09OW2ldLnZlbnVlLmZlYXR1cmVkUGhvdG9zLml0ZW1zWzBdLnN1ZmZpeDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpdGVtLmltZ1NyYyA9IFwiaHR0cDovL3BsYWNlaG9sZC5pdC8yMDB4MTUwP3RleHQ9XCIgKyBnb3RKU09OW2ldLnZlbnVlLmNhdGVnb3JpZXNbMF0uc2hvcnROYW1lO1xuICAgICAgICB9XG4gICAgICAgIGlmIChnb3RKU09OW2ldLmhhc093blByb3BlcnR5KCd0aXBzJykpIHtcbiAgICAgICAgICBpdGVtLnNuaXBwZXQgPSBnb3RKU09OW2ldLnRpcHNbMF0udGV4dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpdGVtLnNuaXBwZXQgPSBcIk5vIHJldmlld3MgeWV0Li4uXCI7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0cy5wdXNoKGl0ZW0pO1xuICAgICAgfVxuICAgICAgLy8gZG8gb3RoZXIgd29yayB3aXRoIHlvdXIgcmVzdWx0cyBiZWxvdyBoZXJlXG4gICAgICByZXN1bHRzLmZvckVhY2goZnVuY3Rpb24oanNvbikge1xuICAgICAgICBzZWxmLmxvY2F0aW9uTGlzdC5wdXNoKG5ldyBQb2koanNvbikpO1xuICAgICAgfSk7XG4gICAgfSlcbiAgICAuZmFpbChmdW5jdGlvbihqcXhociwgdGV4dFN0YXR1cywgZXJyb3IpIHtcbiAgICAgIHZhciBlcnIgPSB0ZXh0U3RhdHVzICsgXCIsIFwiICsgZXJyb3I7XG4gICAgICBhbGVydChcIlJlcXVlc3RlZCBGb3VyU3F1YXJlIGRhdGEgZmFpbGVkIHRvIGxvYWQ6IFxcblwiICsgZXJyKTtcbiAgICB9KTtcblxuICAvLyB1c2UgZmlyc3QgcG9pIGluIE9yYmUgdG8gdGVzdCBzZWxlY3RlZCBwbGFjZVxuICBzZWxmLmN1cnJlbnRQb2kgPSBrby5vYnNlcnZhYmxlKHRoaXMubG9jYXRpb25MaXN0KClbMF0ubmFtZSgpKTtcbiAgY29uc29sZS5sb2coc2VsZi5jdXJyZW50UG9pKCkpO1xuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvLyBzZWFyY2ggc2VjdGlvblxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAvLyBkYXRhLWJpbmQgc2VhcmNoTmFtZSB0byB0aGUgZm9ybSBpbnB1dCBpbiBsZWZ0IG5hdiAtIHZhbHVlOiBzZWFyY2hOYW1lXG4gIC8vIGRhdGEtYmluZCB0byB1cGRhdGUgb24gbmV3IGxldHRlciAtIHZhbHVlVXBkYXRlOiAnYWZ0ZXJrZXlkb3duJ1xuICAvLyBzZXRWaXNpYmxlIGlzIGEgbWV0aG9kIG9uIGdvb2dsZSBtYXJrZXJcbiAgc2VsZi5zZWFyY2hSZXN1bHRzID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgdmFyIHJlc3VsdHMgPSBbXTtcbiAgICAvLyB1c2UgdmFsdWUgaW4gc2VhcmNoIGJveFxuICAgIHZhciBzZWFyY2ggPSBzZWxmLnNlYXJjaE5hbWUoKS50b0xvd2VyQ2FzZSgpO1xuICAgIC8vIHN0cmluZyBtYXRjaCBmb3IgZWFjaCBwb2kubmFtZSBpbiB0aGUgbG9jYXRpb24gbGlzdFxuICAgIHJldHVybiBrby51dGlscy5hcnJheUZpbHRlcihzZWxmLmxvY2F0aW9uTGlzdCgpLCBmdW5jdGlvbihwb2kpIHtcbiAgICAgIGlmIChwb2kubmFtZSgpLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihzZWFyY2gpID49IDApIHtcbiAgICAgICAgcmVzdWx0cy5wdXNoKHBvaSk7XG4gICAgICAgIHJlc2V0TWFya2VycygpO1xuICAgICAgICAvLyBzaG93IG1hcmtlclxuICAgICAgICBwb2kubWFwTWFya2VyLnNldFZpc2libGUodHJ1ZSk7XG4gICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gaGlkZSBtYXJrZXJcbiAgICAgICAgcG9pLm1hcE1hcmtlci5zZXRWaXNpYmxlKGZhbHNlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG5cbiAgLy8gY2xpY2sgb24gbGlzdCBpdGVtXG4gIHNlbGYuc2V0Q3VycmVudFBvaSA9IGZ1bmN0aW9uKHBvaSkge1xuICAgIGFjdGl2YXRlTWFya2VyKG1hcCwgcG9pLm1hcE1hcmtlciwgcG9pKTtcbiAgICBzZWxmLmN1cnJlbnRQb2kocG9pLm5hbWUoKSk7XG4gIH07XG59O1xuXG4vLyBJZiBjYWxsIHRvIGdvb2dsZSBtYXBzIGFwaSBzdWNjZXNzZnVsIGNyZWF0ZSB2aWV3bW9kZWwgYW5kIGFwcGx5IGJpbmRpbmdzXG5mdW5jdGlvbiBnb29nbGVTdWNjZXNzKCkge1xuICBpZiAodHlwZW9mIGdvb2dsZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBpbml0TWFwKCk7XG4gICAga28uYXBwbHlCaW5kaW5ncyhuZXcgVmlld01vZGVsKCkpO1xuICB9IGVsc2Uge1xuICAgIGdvb2dsZUxvYWRFcnJvcigpO1xuICB9XG59XG5cbi8vIEVycm9yIGhhbmRsaW5nIGZvciB0aGUgR29vZ2xlIE1hcHNcbnZhciBnb29nbGVMb2FkRXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgYWxlcnQoJ0dvb2dsZSBtYXBzIGxvYWQgZXJyb3InKTtcbn07Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
